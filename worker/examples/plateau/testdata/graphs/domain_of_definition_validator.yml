id: b7396083-17d0-47dd-be86-83caf6c5ac63
name: domain_of_definition_validator
nodes:
  - id: d72a788d-f9fa-4c4d-b7dd-dd131839accd
    name: FeatureTransformer01
    type: action
    action: FeatureTransformer
    with:
      transformers:
        - expr: |
            env.get("__all") + #{
              meshCode: str::extract_single_by_regex("^(.+?)_.+$", file::extract_filename(env.get("__value").cityGmlPath))
            }

  - id: 747d2fa3-2527-4324-b630-92fba84a548c
    name: PLATEAU.DomainOfDefinitionValidator01
    type: action
    action: PLATEAU.DomainOfDefinitionValidator

  - id: 6f53b8d5-c238-471f-95c5-4987f1c315f2
    name: FeatureFilter01
    type: action
    action: FeatureFilter
    with:
      conditions:
        - expr: |
            env.get("__value").flag == "Summary"
          outputPort: summary
        - expr: |
            env.get("__value").flag == "CodeValidation"
          outputPort: codeValidation
        - expr: |
            env.get("__value").flag == "ExtentsValidation"
          outputPort: extentsValidation
        - expr: |
            env.get("__value").flag == "GMLID_NotWellFormed"
          outputPort: gmlIdNotWellFormed
        - expr: |
            env.get("__value").flag == "GMLID_NotUnique"
          outputPort: gmlIdNotUnique
        - expr: |
            env.get("__value").flag == "XLink_NoReference"
          outputPort: xlinkNoReference
        - expr: |
            env.get("__value").flag == "XLink_InvalidObjectType"
          outputPort: xLinkInvalidObjectType
        - expr: |
            env.get("__value").flag == "InvalidLodXGeometry"
          outputPort: invalidLodXGeometry

edges:
  - id: afa36141-5b6a-4d2b-8a75-bf184f961378
    from: d72a788d-f9fa-4c4d-b7dd-dd131839accd
    to: 747d2fa3-2527-4324-b630-92fba84a548c
    fromPort: default
    toPort: default
  - id: d661eff9-2ee3-4735-ab36-ac2c662464fd
    from: 747d2fa3-2527-4324-b630-92fba84a548c
    to: 6f53b8d5-c238-471f-95c5-4987f1c315f2
    fromPort: default
    toPort: default
