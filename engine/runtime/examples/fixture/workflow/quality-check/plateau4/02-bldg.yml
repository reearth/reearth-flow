id: f2e8a945-7b3c-4d1e-9a8f-3c5b7e9d2f84
name: PLATEAU4-quality-check-02-bldg-workflow
entryGraphId: 8a6c4f2e-9b1d-4e7a-b3c5-6f8e2a4b9d7c
with:
  cityGmlPath: null
  codelists: null
  schemas: null
  objectLists: null
  outputPath: null
graphs:
- id: 7e98d856-1438-4148-bdcb-91747ef2e405
  name: PLATEAU3.LodSplitterWithDM
  nodes:
  - id: 5848465e-828f-4646-874e-e2f182b73714
    name: InputRouter
    type: action
    action: InputRouter
    with:
      routingPort: default
  - id: a1b2c3d4-e5f6-7890-abcd-ef1234567890
    name: DmGeometricAttributeFilter
    type: action
    action: FeatureFilter
    with:
      conditions:
      - expr: |
          env.get("__feature_type") == "uro:DmGeometricAttribute"
        outputPort: DmGeometricAttribute
  - id: 278ab965-ce22-473d-98c6-c7b381c38679
    name: GeometryFilter
    type: action
    action: GeometryFilter
    with:
      filterType: none
  - id: 1787b15c-19b5-4386-a0ff-f0e58f477d07
    name: FeatureFilterByExceptSplit
    type: action
    action: FeatureFilter
    with:
      conditions:
      - expr: |
          env.get("exceptSplit") ?? false
        outputPort: exceptSplit
  - id: 8fe1a102-e3f3-40dd-b235-66e9c148830f
    name: GeometrySplitter
    type: action
    action: GeometrySplitter
  - id: 7c843a02-3b1f-40c1-8214-562e72bfb9a6
    name: FeatureFilterByLod
    type: action
    action: FeatureFilter
    with:
      conditions:
      - expr: |
          env.get("__value").lod == "0"
        outputPort: lod0
      - expr: |
          env.get("__value").lod == "1"
        outputPort: lod1
      - expr: |
          env.get("__value").lod == "2"
        outputPort: lod2
      - expr: |
          env.get("__value").lod == "3"
        outputPort: lod3
      - expr: |
          env.get("__value").lod == "4"
        outputPort: lod4
  - id: b1c2d3e4-f5a6-7890-bcde-f12345678901
    name: DmGeometricAttributeRouter
    type: action
    action: OutputRouter
    with:
      routingPort: DmGeometricAttribute
  - id: dab9d3b6-594e-40cc-9f6b-c605005e3320
    name: Lod0Router
    type: action
    action: OutputRouter
    with:
      routingPort: lod0
  - id: dab9d3b6-594e-40cc-9f6b-c605005e3321
    name: Lod1Router
    type: action
    action: OutputRouter
    with:
      routingPort: lod1
  - id: dab9d3b6-594e-40cc-9f6b-c605005e3322
    name: Lod2Router
    type: action
    action: OutputRouter
    with:
      routingPort: lod2
  - id: dab9d3b6-594e-40cc-9f6b-c605005e3323
    name: Lod3Router
    type: action
    action: OutputRouter
    with:
      routingPort: lod3
  - id: dab9d3b6-594e-40cc-9f6b-c605005e3324
    name: Lod4Router
    type: action
    action: OutputRouter
    with:
      routingPort: lod4
  edges:
  - id: fcc0d596-9169-4289-9f35-07c8cbec6f10
    from: 5848465e-828f-4646-874e-e2f182b73714
    to: a1b2c3d4-e5f6-7890-abcd-ef1234567890
    fromPort: default
    toPort: default
  - id: c1d2e3f4-a5b6-7c8d-9e0f-1a2b3c4d5e6f
    from: a1b2c3d4-e5f6-7890-abcd-ef1234567890
    to: 278ab965-ce22-473d-98c6-c7b381c38679
    fromPort: unfiltered
    toPort: default
  - id: d2e3f4a5-b6c7-8d9e-0f1a-2b3c4d5e6f7a
    from: a1b2c3d4-e5f6-7890-abcd-ef1234567890
    to: b1c2d3e4-f5a6-7890-bcde-f12345678901
    fromPort: DmGeometricAttribute
    toPort: default
  - id: 1386a662-cf02-4475-a5d2-3668a50a56b7
    from: 278ab965-ce22-473d-98c6-c7b381c38679
    to: 1787b15c-19b5-4386-a0ff-f0e58f477d07
    fromPort: unfiltered
    toPort: default
  - id: ef2f1484-6173-4f34-85bc-58bc45e31bff
    from: 1787b15c-19b5-4386-a0ff-f0e58f477d07
    to: 8fe1a102-e3f3-40dd-b235-66e9c148830f
    fromPort: unfiltered
    toPort: default
  - id: 111cc70e-e1ad-44f4-b4c8-82f7b1cf1309
    from: 8fe1a102-e3f3-40dd-b235-66e9c148830f
    to: 7c843a02-3b1f-40c1-8214-562e72bfb9a6
    fromPort: default
    toPort: default
  - id: 5857909b-7fc0-4d3e-adfa-65a5669a6646
    from: 1787b15c-19b5-4386-a0ff-f0e58f477d07
    to: 7c843a02-3b1f-40c1-8214-562e72bfb9a6
    fromPort: exceptSplit
    toPort: default
  - id: 1a802e2e-c876-42e3-b3ae-639af1bc7780
    from: 7c843a02-3b1f-40c1-8214-562e72bfb9a6
    to: dab9d3b6-594e-40cc-9f6b-c605005e3320
    fromPort: lod0
    toPort: default
  - id: 1a802e2e-c876-42e3-b3ae-639af1bc7781
    from: 7c843a02-3b1f-40c1-8214-562e72bfb9a6
    to: dab9d3b6-594e-40cc-9f6b-c605005e3321
    fromPort: lod1
    toPort: default
  - id: 1a802e2e-c876-42e3-b3ae-639af1bc7782
    from: 7c843a02-3b1f-40c1-8214-562e72bfb9a6
    to: dab9d3b6-594e-40cc-9f6b-c605005e3322
    fromPort: lod2
    toPort: default
  - id: 1a802e2e-c876-42e3-b3ae-639af1bc7783
    from: 7c843a02-3b1f-40c1-8214-562e72bfb9a6
    to: dab9d3b6-594e-40cc-9f6b-c605005e3323
    fromPort: lod3
    toPort: default
  - id: 1a802e2e-c876-42e3-b3ae-639af1bc7784
    from: 7c843a02-3b1f-40c1-8214-562e72bfb9a6
    to: dab9d3b6-594e-40cc-9f6b-c605005e3324
    fromPort: lod4
    toPort: default
- id: 8a5b1c9d-2e4f-4a3b-9c5d-1e6f8a2b4c7d
  name: PLATEAU3.SurfaceValidator3D
  nodes:
  - id: 2f8a4b1c-5e9d-4c2a-8b6e-3f7a9b2c5d8e
    name: InputRouter
    type: action
    action: InputRouter
    with:
      routingPort: default
  - id: 4c7a2b5e-8f1d-4a6c-9e2b-7a4c8e1b3f6d
    name: Noop
    type: action
    action: NoopProcessor
  - id: 6e3b8a1c-f4d7-4b9e-a2c5-8f1b4e6a9c3d
    name: SurfaceRouter
    type: action
    action: OutputRouter
    with:
      routingPort: default
  - id: 1a9c4e7b-2f5d-4e8a-b3c6-9f2a5e8b1c4d
    name: GeometryPartExtractor
    type: action
    action: GeometryPartExtractor
  - id: 3d6f9a2c-5b8e-4a1d-c7f4-2e5a8c3b6f9d
    name: TwoDimensionForcer
    type: action
    action: TwoDimensionForcer
  - id: 5c2a7f4b-8e1d-4f9c-a6e3-4b7f2a5c8e1d
    name: OrientationExtractor
    type: action
    action: OrientationExtractor
    with:
      outputAttribute: outerOrientation
  - id: 7f4a1c6e-b9d2-4c5a-e8f1-6a3c7f4b9e2d
    name: FeatureFilterByOrientation
    type: action
    action: FeatureFilter
    with:
      conditions:
      - expr: |
          env.get("__value").outerOrientation != "counter_clockwise"
        outputPort: inCorrectOrientation
  - id: 9e2b5f8a-1c4d-4a7e-f2b5-8a1e4b7c2f5d
    name: GeometryReplacer
    type: action
    action: GeometryReplacer
    with:
      sourceAttribute: dumpGeometry
  - id: 2a5c8f1b-4e7d-4b2c-a9f6-1c4e7a2b5f8d
    name: InCorrectOrientationRouter
    type: action
    action: OutputRouter
    with:
      routingPort: inCorrectOrientation
  - id: 4f8b3e6a-7d1c-4e5a-c2f9-3a6f9b4e7c1d
    name: GeometryValidator
    type: action
    action: GeometryValidator
    with:
      validationTypes:
      - duplicatePoints
      - corruptGeometry
  - id: 6a1d4f7c-9e2b-4c8a-f5e1-7c2a6f9d4e1b
    name: PlanarityFilter
    type: action
    action: PlanarityFilter
  - id: 8c5f2a9d-1b4e-4f7c-a3d8-5e2c8f1b4a7d
    name: FeatureCounter
    type: action
    action: FeatureCounter
    with:
      countStart: 0
      outputAttribute: surfaceId
  - id: 1e7a4c9b-3f6d-4a2e-c8b5-9d2a5e8c1b4f
    name: HoleCounter
    type: action
    action: HoleCounter
    with:
      outputAttribute: holeCount
  - id: 3b9f6a2d-5c8e-4d1a-f7c4-2e5b8a3f6d9c
    name: FeatureFilterByHole
    type: action
    action: FeatureFilter
    with:
      conditions:
      - expr: |
          true
        outputPort: default
      - expr: |
          env.get("__value").holeCount > 0
        outputPort: hole
  - id: 5d2c7f4a-8b1e-4c6d-a9f2-4a7d2c5f8b1e
    name: GeometryValidatorSelfIntersection
    type: action
    action: GeometryValidator
    with:
      validationTypes:
      - duplicateConsecutivePoints
      - selfIntersection
  - id: 7f5a8c3b-1d4e-4a9f-c2b7-6e3a7f5c8b1d
    name: GeometryCoercerRingNotClosed
    type: action
    action: GeometryCoercer
    with:
      targetType: lineString
  - id: 9c1e4a7b-6f2d-4e5c-a8b1-3f6c9e1a4b7d
    name: ClosedCurveFilter
    type: action
    action: ClosedCurveFilter
  - id: 2d8a5f3c-4b7e-4c1d-f9a6-8c2d5a8f3b6e
    name: HoleExtractor
    type: action
    action: HoleExtractor
  - id: 4a6c9f2d-7e3b-4d8a-c5f2-1a4c7e9f2d5b
    name: OrientationExtractorOuterShell
    type: action
    action: OrientationExtractor
    with:
      outputAttribute: outerOrientation
  - id: 6f3b1a8e-9c4d-4a7f-e2c9-3b6f1a8e4c7d
    name: ElevationExtractorHole
    type: action
    action: ElevationExtractor
    with:
      outputAttribute: elevation
  - id: 8e7c4a1f-2d5b-4f8e-a6c3-7f4e1c8a5b2d
    name: GeometryCoercerOutershell
    type: action
    action: GeometryCoercer
    with:
      targetType: lineString
  - id: 1c4f7a2e-5b8d-4a3c-f9e6-4c1f8a7e2b5d
    name: GeometryCoercerHole
    type: action
    action: GeometryCoercer
    with:
      targetType: lineString
  - id: 3f5a8c1d-7e4b-4c9f-a2e7-6f3a8c1d4e7b
    name: FeatureCounterHole
    type: action
    action: FeatureCounter
    with:
      countStart: 1
      groupBy:
      - surfaceId
      outputAttribute: holeId
  - id: 5b8d1f4a-9c6e-4f2b-c8d5-1f4b8d5a9c2e
    name: FeatureMergerIntersectionbetweenInteriorAndExterior
    type: action
    action: FeatureMerger
    with:
      requestorAttribute:
      - surfaceId
      supplierAttribute:
      - surfaceId
      completeGrouped: true
  - id: 7d4e9a2c-1f5b-4d8a-e7c4-9a2d7e4c1f5b
    name: LineOnLineOverlayer
    type: action
    action: LineOnLineOverlayer
    with:
      groupBy:
      - surfaceId
      - holeId
      tolerance: 0.001
      outputAttribute: overlap
  - id: 9a6c3f8b-4e1d-4a7c-f5b9-3f8a6c9b4e1d
    name: Bufferer
    type: action
    action: Bufferer
    with:
      bufferType: area2d
      distance: 0.005
      interpolationAngle: 22.5
  - id: 2c7f4a9e-8b1d-4f6c-a3e8-7f2c4a9e1b8d
    name: AreaOnAreaOverlayerInteriorAndInterior
    type: action
    action: AreaOnAreaOverlayer
    with:
      groupBy:
      - surfaceId
      accumulationMode: useAttributesFromOneFeature
      outputAttribute: overlap
  - id: 4e1b7c5a-6f9d-4c2e-b8a5-1c4e7b5a6f9d
    name: FeatureFilterByAreaOnAreaOverlap
    type: action
    action: FeatureFilter
    with:
      conditions:
      - expr: |
          env.get("__value").overlap > 1
        outputPort: intersectionInterior
  - id: 5a3b7e9c-2f4d-4a6e-b8c1-3e7a5b9c2f4d
    name: AttributeManagerIntersectionInterior
    type: action
    action: AttributeManager
    with:
      operations:
      - attribute: issue
        method: create
        value: |
          "IntersectionBetweenInteriorAndInterior"
  - id: 6b5d8a3f-1c4e-4b7d-a9c2-5d6b8a3f1c4e
    name: OrientationExtractorIncorrectInterior
    type: action
    action: OrientationExtractor
    with:
      outputAttribute: innerOrientation
  - id: 8f2a5c7d-3e6b-4a9f-c1d4-2a8f5c7d3e6b
    name: FeatureMergerIncorrectInterior
    type: action
    action: FeatureMerger
    with:
      requestorAttribute:
      - surfaceId
      supplierAttribute:
      - surfaceId
      completeGrouped: true
  - id: 1a4d7c2f-9e5b-4d8a-f6c3-4d1a7c2f9e5b
    name: FeatureFilterByIncorrectInteriorOrientation
    type: action
    action: FeatureFilter
    with:
      conditions:
      - expr: |
          env.get("__value").innerOrientation == env.get("__value").outerOrientation
        outputPort: incorrectInterior
  - id: 4b8e2a7d-3f6c-4a1e-b9d5-7a4b8e2d3f6c
    name: AttributeManagerIncorrectInteriorOrientation
    type: action
    action: AttributeManager
    with:
      operations:
      - attribute: issue
        method: create
        value: |
          "IncorrectInteriorOrientation"
  - id: 3c6f9a1e-8d4b-4f3c-a7e2-6f3c9a1e8d4b
    name: InvalidSurfaceRouter
    type: action
    action: OutputRouter
    with:
      routingPort: invalidSurface
  edges:
  - id: 5e8b2a7f-1c4d-4e9b-a6f3-8b5e2a7f1c4d
    from: 2f8a4b1c-5e9d-4c2a-8b6e-3f7a9b2c5d8e
    to: 4c7a2b5e-8f1d-4a6c-9e2b-7a4c8e1b3f6d
    fromPort: default
    toPort: default
  - id: 7f3a6c9e-4d1b-4c7f-e2a5-3f7a6c9e4d1b
    from: 4c7a2b5e-8f1d-4a6c-9e2b-7a4c8e1b3f6d
    to: 6e3b8a1c-f4d7-4b9e-a2c5-8f1b4e6a9c3d
    fromPort: default
    toPort: default
  - id: 9d6a3f2c-8e5b-4a1d-c7f4-6a9d3f2c8e5b
    from: 4c7a2b5e-8f1d-4a6c-9e2b-7a4c8e1b3f6d
    to: 1a9c4e7b-2f5d-4e8a-b3c6-9f2a5e8b1c4d
    fromPort: default
    toPort: default
  - id: 2c5f8a1d-6e9b-4c2f-a7e4-5c2f8a1d6e9b
    from: 1a9c4e7b-2f5d-4e8a-b3c6-9f2a5e8b1c4d
    to: 3d6f9a2c-5b8e-4a1d-c7f4-2e5a8c3b6f9d
    fromPort: extracted
    toPort: default
  - id: 4a7e1c5b-9f2d-4a8e-c6f3-7e4a1c5b9f2d
    from: 3d6f9a2c-5b8e-4a1d-c7f4-2e5a8c3b6f9d
    to: 5c2a7f4b-8e1d-4f9c-a6e3-4b7f2a5c8e1d
    fromPort: default
    toPort: default
  - id: 6f9c4a2e-1d5b-4f7c-e8a1-9c6f4a2e1d5b
    from: 5c2a7f4b-8e1d-4f9c-a6e3-4b7f2a5c8e1d
    to: 7f4a1c6e-b9d2-4c5a-e8f1-6a3c7f4b9e2d
    fromPort: default
    toPort: default
  - id: 8b1e6a3f-4c7d-4b8e-a2f5-1e8b6a3f4c7d
    from: 7f4a1c6e-b9d2-4c5a-e8f1-6a3c7f4b9e2d
    to: 9e2b5f8a-1c4d-4a7e-f2b5-8a1e4b7c2f5d
    fromPort: inCorrectOrientation
    toPort: default
  - id: 1d4a7c2e-8f5b-4d1a-c9f6-4a1d7c2e8f5b
    from: 9e2b5f8a-1c4d-4a7e-f2b5-8a1e4b7c2f5d
    to: 2a5c8f1b-4e7d-4b2c-a9f6-1c4e7a2b5f8d
    fromPort: default
    toPort: default
  - id: 3f6c9a2d-7e4b-4f3c-a8e1-6c3f9a2d7e4b
    from: 1a9c4e7b-2f5d-4e8a-b3c6-9f2a5e8b1c4d
    to: 4f8b3e6a-7d1c-4e5a-c2f9-3a6f9b4e7c1d
    fromPort: extracted
    toPort: default
  - id: 5c8a1f4d-9e2b-4c5a-f7d2-8c5a1f4d9e2b
    from: 4f8b3e6a-7d1c-4e5a-c2f9-3a6f9b4e7c1d
    to: 6a1d4f7c-9e2b-4c8a-f5e1-7c2a6f9d4e1b
    fromPort: success
    toPort: default
  - id: 7e4b9f2a-1c6d-4e7b-a3f8-4b7e9f2a1c6d
    from: 6a1d4f7c-9e2b-4c8a-f5e1-7c2a6f9d4e1b
    to: 3c6f9a1e-8d4b-4f3c-a7e2-6f3c9a1e8d4b
    fromPort: notplanarity
    toPort: default
  - id: 9a2f5c8d-6e1b-4a9f-c4d7-2a9f5c8d6e1b
    from: 6a1d4f7c-9e2b-4c8a-f5e1-7c2a6f9d4e1b
    to: 8c5f2a9d-1b4e-4f7c-a3d8-5e2c8f1b4a7d
    fromPort: planarity
    toPort: default
  - id: 2d7a4c1f-5e8b-4d2a-f6c9-7a2d4c1f5e8b
    from: 8c5f2a9d-1b4e-4f7c-a3d8-5e2c8f1b4a7d
    to: 1e7a4c9b-3f6d-4a2e-c8b5-9d2a5e8c1b4f
    fromPort: default
    toPort: default
  - id: 4b6d9a3c-8f1e-4b6d-a2c7-6b4d9a3c8f1e
    from: 1e7a4c9b-3f6d-4a2e-c8b5-9d2a5e8c1b4f
    to: 3b9f6a2d-5c8e-4d1a-f7c4-2e5b8a3f6d9c
    fromPort: default
    toPort: default
  - id: 6f1c4a7e-9d2b-4f1c-e5a8-1f6c4a7e9d2b
    from: 3b9f6a2d-5c8e-4d1a-f7c4-2e5b8a3f6d9c
    to: 5d2c7f4a-8b1e-4c6d-a9f2-4a7d2c5f8b1e
    fromPort: default
    toPort: default
  - id: 8c4e7a1d-2f5b-4c8e-a1d4-4e8c7a1d2f5b
    from: 5d2c7f4a-8b1e-4c6d-a9f2-4a7d2c5f8b1e
    to: 7f5a8c3b-1d4e-4a9f-c2b7-6e3a7f5c8b1d
    fromPort: success
    toPort: default
  - id: 1a5e8c2d-6f9b-4a1e-c7d2-5a1e8c2d6f9b
    from: 5d2c7f4a-8b1e-4c6d-a9f2-4a7d2c5f8b1e
    to: 3c6f9a1e-8d4b-4f3c-a7e2-6f3c9a1e8d4b
    fromPort: failed
    toPort: default
  - id: 3d8b5a2f-7c4e-4d8b-a6f1-8b3d5a2f7c4e
    from: 7f5a8c3b-1d4e-4a9f-c2b7-6e3a7f5c8b1d
    to: 9c1e4a7b-6f2d-4e5c-a8b1-3f6c9e1a4b7d
    fromPort: default
    toPort: default
  - id: 5f2c8a6d-1e4b-4f2c-a9e4-2c5f8a6d1e4b
    from: 9c1e4a7b-6f2d-4e5c-a8b1-3f6c9e1a4b7d
    to: 3c6f9a1e-8d4b-4f3c-a7e2-6f3c9a1e8d4b
    fromPort: open
    toPort: default
  - id: 7a6f3c9b-4e2d-4a7a-c1f6-6f7a3c9b4e2d
    from: 3b9f6a2d-5c8e-4d1a-f7c4-2e5b8a3f6d9c
    to: 2d8a5f3c-4b7e-4c1d-f9a6-8c2d5a8f3b6e
    fromPort: hole
    toPort: default
  - id: 9c4a7f2e-8d1b-4c9a-f3e6-4a9c7f2e8d1b
    from: 2d8a5f3c-4b7e-4c1d-f9a6-8c2d5a8f3b6e
    to: 4a6c9f2d-7e3b-4d8a-c5f2-1a4c7e9f2d5b
    fromPort: outershell
    toPort: default
  - id: 2e7b4a1c-6f9d-4e2b-a8c5-7b2e4a1c6f9d
    from: 2d8a5f3c-4b7e-4c1d-f9a6-8c2d5a8f3b6e
    to: 6f3b1a8e-9c4d-4a7f-e2c9-3b6f1a8e4c7d
    fromPort: hole
    toPort: default
  - id: 4c8f5a3d-1e6b-4c8f-a2d5-8f4c5a3d1e6b
    from: 4a6c9f2d-7e3b-4d8a-c5f2-1a4c7e9f2d5b
    to: 8e7c4a1f-2d5b-4f8e-a6c3-7f4e1c8a5b2d
    fromPort: default
    toPort: default
  - id: 6a1d7c4f-9e2b-4a1d-c8f5-1a6d7c4f9e2b
    from: 6f3b1a8e-9c4d-4a7f-e2c9-3b6f1a8e4c7d
    to: 1c4f7a2e-5b8d-4a3c-f9e6-4c1f8a7e2b5d
    fromPort: default
    toPort: default
  - id: 8f4c1a6e-3d7b-4f8c-a5e2-4c8f1a6e3d7b
    from: 1c4f7a2e-5b8d-4a3c-f9e6-4c1f8a7e2b5d
    to: 3f5a8c1d-7e4b-4c9f-a2e7-6f3a8c1d4e7b
    fromPort: default
    toPort: default
  - id: 1d7a4c2f-8e5b-4d1a-c6f9-7a1d4c2f8e5b
    from: 8e7c4a1f-2d5b-4f8e-a6c3-7f4e1c8a5b2d
    to: 5b8d1f4a-9c6e-4f2b-c8d5-1f4b8d5a9c2e
    fromPort: default
    toPort: requestor
  - id: 3b6f9a4d-2c8e-4b3b-a7f2-6f3b9a4d2c8e
    from: 3f5a8c1d-7e4b-4c9f-a2e7-6f3a8c1d4e7b
    to: 5b8d1f4a-9c6e-4f2b-c8d5-1f4b8d5a9c2e
    fromPort: default
    toPort: supplier
  - id: 5e2c8f1a-4d7b-4e5e-c9a6-2c5e8f1a4d7b
    from: 5b8d1f4a-9c6e-4f2b-c8d5-1f4b8d5a9c2e
    to: 7d4e9a2c-1f5b-4d8a-e7c4-9a2d7e4c1f5b
    fromPort: merged
    toPort: default
  - id: 7a9d2c5f-6e8b-4a7a-f1d4-9d7a2c5f6e8b
    from: 3f5a8c1d-7e4b-4c9f-a2e7-6f3a8c1d4e7b
    to: 7d4e9a2c-1f5b-4d8a-e7c4-9a2d7e4c1f5b
    fromPort: default
    toPort: default
  - id: 9c6a5f2d-8e1b-4c9c-a4f7-6a9c5f2d8e1b
    from: 7d4e9a2c-1f5b-4d8a-e7c4-9a2d7e4c1f5b
    to: 3c6f9a1e-8d4b-4f3c-a7e2-6f3c9a1e8d4b
    fromPort: point
    toPort: default
  - id: 2f8a5c1d-7e4b-4f2f-a6c9-8a2f5c1d7e4b
    from: 6f3b1a8e-9c4d-4a7f-e2c9-3b6f1a8e4c7d
    to: 9a6c3f8b-4e1d-4a7c-f5b9-3f8a6c9b4e1d
    fromPort: default
    toPort: default
  - id: 4d1c7a5e-9f2b-4d4d-c8a3-1c4d7a5e9f2b
    from: 9a6c3f8b-4e1d-4a7c-f5b9-3f8a6c9b4e1d
    to: 2c7f4a9e-8b1d-4f6c-a3e8-7f2c4a9e1b8d
    fromPort: default
    toPort: default
  - id: 6e5b8a2f-1c4d-4e6e-b9f4-5b6e8a2f1c4d
    from: 2c7f4a9e-8b1d-4f6c-a3e8-7f2c4a9e1b8d
    to: 4e1b7c5a-6f9d-4c2e-b8a5-1c4e7b5a6f9d
    fromPort: area
    toPort: default
  - id: 8a3f6c9d-4e7b-4a8a-f2c5-3f8a6c9d4e7b
    from: 4e1b7c5a-6f9d-4c2e-b8a5-1c4e7b5a6f9d
    to: 5a3b7e9c-2f4d-4a6e-b8c1-3e7a5b9c2f4d
    fromPort: intersectionInterior
    toPort: default
  - id: 9b4c8e2a-6f7d-4b9c-e1a4-2e8b4c9a6f7d
    from: 5a3b7e9c-2f4d-4a6e-b8c1-3e7a5b9c2f4d
    to: 3c6f9a1e-8d4b-4f3c-a7e2-6f3c9a1e8d4b
    fromPort: default
    toPort: default
  - id: 1c7d4a2e-9f5b-4c1c-d8e3-7d1c4a2e9f5b
    from: 6f3b1a8e-9c4d-4a7f-e2c9-3b6f1a8e4c7d
    to: 6b5d8a3f-1c4e-4b7d-a9c2-5d6b8a3f1c4e
    fromPort: default
    toPort: default
  - id: 3e6a9c2f-8d1b-4e3e-a7c4-6a3e9c2f8d1b
    from: 6b5d8a3f-1c4e-4b7d-a9c2-5d6b8a3f1c4e
    to: 8f2a5c7d-3e6b-4a9f-c1d4-2a8f5c7d3e6b
    fromPort: default
    toPort: requestor
  - id: 5b4f7c1a-2e9d-4b5b-c6a9-4f5b7c1a2e9d
    from: 4a6c9f2d-7e3b-4d8a-c5f2-1a4c7e9f2d5b
    to: 8f2a5c7d-3e6b-4a9f-c1d4-2a8f5c7d3e6b
    fromPort: default
    toPort: supplier
  - id: 7d9c2a5f-6e8b-4d7d-c1f6-9c7d2a5f6e8b
    from: 8f2a5c7d-3e6b-4a9f-c1d4-2a8f5c7d3e6b
    to: 1a4d7c2f-9e5b-4d8a-f6c3-4d1a7c2f9e5b
    fromPort: merged
    toPort: default
  - id: 9f2e5c8a-1d4b-4f9f-e4c7-2e9f5c8a1d4b
    from: 1a4d7c2f-9e5b-4d8a-f6c3-4d1a7c2f9e5b
    to: 4b8e2a7d-3f6c-4a1e-b9d5-7a4b8e2d3f6c
    fromPort: incorrectInterior
    toPort: default
  - id: 7c3f1a6e-9d2b-4c8f-a5e1-3f7c1a6e9d2b
    from: 4b8e2a7d-3f6c-4a1e-b9d5-7a4b8e2d3f6c
    to: 3c6f9a1e-8d4b-4f3c-a7e2-6f3c9a1e8d4b
    fromPort: default
    toPort: default
  - id: 2a5c8f1d-7e4b-4f2a-c9e6-5c2a8f1d7e4b
    from: 4f8b3e6a-7d1c-4e5a-c2f9-3a6f9b4e7c1d
    to: 3c6f9a1e-8d4b-4f3c-a7e2-6f3c9a1e8d4b
    fromPort: failed
    toPort: default
- id: 1a2b3c4d-5e6f-7a8b-9c0d-1e2f3a4b5c6d
  name: buildingPartValidation
  nodes:
  - id: c223c809-eba3-4d73-8f1b-34d27515bb17
    name: InputRouter
    type: action
    action: InputRouter
    with:
      routingPort: default
  - id: a5aefda5-b66f-4d20-b8b8-5b1aa322ec8e
    name: PLATEAU3.LodSplitterWithDM
    type: subGraph
    subGraphId: 7e98d856-1438-4148-bdcb-91747ef2e405
  - id: 7b9c8d4e-6f5a-4c8b-9d3e-2a5f7b8c9d4e
    name: AttributeMapperBuildingPartLod0Or1
    type: action
    action: AttributeMapper
    with:
      mappers:
      - attribute: Index
        expr: env.get("__value").fileIndex
      - attribute: Filename
        expr: env.get("__value").gmlFilename
      - attribute: Building.gml_id
        expr: env.get("__value").gmlId
      - attribute: BuildingPart.gml_id
        expr: env.get("__value").featureId
      - attribute: lod
        expr: env.get("__value").lod
  - id: 9e8f7a6b-5c4d-3e2f-1a0b-9c8d7e6f5a4b
    name: CsvWriterBuildingPartLod0Or1
    type: action
    action: FeatureWriter
    with:
      format: csv
      output: |
        file::join_path(env.get("workerArtifactPath") ?? env.get("outputPath"), "02_建築物_LOD0-1のBuildingPart.csv")
  - id: 77c7d8e9-0f1a-2b3c-4d5e-6f7a8b9c0d1e
    name: Lod0Or1BuildingPartCounter
    type: action
    action: StatisticsCalculator
    with:
      groupBy:
      - gmlFilename
      calculations:
      - newAttribute: _num_lod0_1_buildingpart
        expr: '1'
  - id: 88d8e9f0-1a2b-3c4d-5e6f-7a8b9c0d1e2f
    name: ErrorCount-Lod0Or1BuildingPart
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLod01BuildingPart
  - id: d3c4e5f6-7a8b-9c0d-1e2f-3a4b5c6d7e8f
    name: PLATEAU4.BuildingPartConnectivityChecker
    type: action
    action: PLATEAU4.BuildingPartConnectivityChecker
    with:
      buildingIdAttribute: gmlId
      partIdAttribute: featureId
      lodAttribute: lod
      fileIndexAttribute: fileIndex
  - id: f5e6a7b8-9c0d-1e2f-3a4b-5c6d7e8f9a0b
    name: FilterNonFullStatus
    type: action
    action: FeatureFilter
    with:
      conditions:
      - expr: |
          env.get("__value")._status != "full"
        outputPort: filtered
  - id: a6f7b8c9-0d1e-2f3a-4b5c-6d7e8f9a0b1c
    name: DeduplicateBuildingIds
    type: action
    action: FeatureDuplicateFilter
  - id: b7a8c9d0-1e2f-3a4b-5c6d-7e8f9a0b1c2d
    name: CountLbldg02Errors
    type: action
    action: StatisticsCalculator
    with:
      groupBy:
      - gmlFilename
      calculations:
      - newAttribute: _num_lbldg02_error
        expr: '1'
  - id: c8b9d0e1-2f3a-4b5c-6d7e-8f9a0b1c2d3e
    name: AttributeMapperLbldg02Output
    type: action
    action: AttributeMapper
    with:
      mappers:
      - attribute: Index
        expr: env.get("__value").fileIndex
      - attribute: Filename
        expr: env.get("__value").gmlFilename
      - attribute: Building.gml_id
        expr: env.get("__value").gmlId
      - attribute: BuildingPart.gml_id
        expr: env.get("__value").featureId
      - attribute: lod
        expr: env.get("__value").lod
      - attribute: status
        expr: env.get("__value")._status
      - attribute: connected_id
        expr: env.get("__value")._connected_id
      - attribute: connected_parts
        expr: env.get("__value")._connected_parts
  - id: d9c0e1f2-3a4b-5c6d-7e8f-9a0b1c2d3e4f
    name: CsvWriterLbldg02Errors
    type: action
    action: FeatureWriter
    with:
      format: csv
      output: |
        file::join_path(env.get("workerArtifactPath") ?? env.get("outputPath"), "02_建築物_L-bldg-02エラー.csv")
  - id: e2f3a4b5-6c7d-8e9f-0a1b-2c3d4e5f6a7b
    name: ErrorCount-Lbldg02
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLbldg02
  - id: 3f4e5d6c-7b8a-9c0d-1e2f-3a4b5c6d7e8f
    name: OutputRouter
    type: action
    action: OutputRouter
    with:
      routingPort: fileOutput
  edges:
  - id: ed4f5a6b-7c8d-4e9f-8a1b-2c3d4e5f6a7b
    from: c223c809-eba3-4d73-8f1b-34d27515bb17
    to: a5aefda5-b66f-4d20-b8b8-5b1aa322ec8e
    fromPort: default
    toPort: default
  - id: f8a9b0c1-2d3e-4f5a-9b6c-7d8e9f0a1b2c
    from: a5aefda5-b66f-4d20-b8b8-5b1aa322ec8e
    to: 77c7d8e9-0f1a-2b3c-4d5e-6f7a8b9c0d1e
    fromPort: lod0
    toPort: default
  - id: a1b2c3d4-5e6f-4a7b-8c9d-0e1f2a3b4c5d
    from: a5aefda5-b66f-4d20-b8b8-5b1aa322ec8e
    to: 77c7d8e9-0f1a-2b3c-4d5e-6f7a8b9c0d1e
    fromPort: lod1
    toPort: default
  - id: 66c6d7e8-9f0a-1b2c-3d4e-5f6a7b8c9d0e
    from: 77c7d8e9-0f1a-2b3c-4d5e-6f7a8b9c0d1e
    to: 7b9c8d4e-6f5a-4c8b-9d3e-2a5f7b8c9d4e
    fromPort: complete
    toPort: default
  - id: 5c6d7e8f-9a0b-1c2d-3e4f-5a6b7c8d9e0f
    from: 7b9c8d4e-6f5a-4c8b-9d3e-2a5f7b8c9d4e
    to: 9e8f7a6b-5c4d-3e2f-1a0b-9c8d7e6f5a4b
    fromPort: default
    toPort: default
  - id: 77d7e8f9-0a1b-2c3d-4e5f-6a7b8c9d0e1f
    from: 77c7d8e9-0f1a-2b3c-4d5e-6f7a8b9c0d1e
    to: 88d8e9f0-1a2b-3c4d-5e6f-7a8b9c0d1e2f
    fromPort: default
    toPort: default
  - id: 7e8f9a0b-1c2d-3e4f-5a6b-7c8d9e0f1a2b
    from: 9e8f7a6b-5c4d-3e2f-1a0b-9c8d7e6f5a4b
    to: 3f4e5d6c-7b8a-9c0d-1e2f-3a4b5c6d7e8f
    fromPort: default
    toPort: default
  - id: d6e7f8a9-0b1c-2d3e-4f5a-6b7c8d9e0f1a
    from: d3c4e5f6-7a8b-9c0d-1e2f-3a4b5c6d7e8f
    to: f5e6a7b8-9c0d-1e2f-3a4b-5c6d7e8f9a0b
    fromPort: default
    toPort: default
  - id: f8a9b0c1-2d3e-4f5a-6b7c-8d9e0f1a2b3c
    from: f5e6a7b8-9c0d-1e2f-3a4b-5c6d7e8f9a0b
    to: a6f7b8c9-0d1e-2f3a-4b5c-6d7e8f9a0b1c
    fromPort: filtered
    toPort: default
  - id: a9b0c1d2-3e4f-5a6b-7c8d-9e0f1a2b3c4d
    from: a6f7b8c9-0d1e-2f3a-4b5c-6d7e8f9a0b1c
    to: b7a8c9d0-1e2f-3a4b-5c6d-7e8f9a0b1c2d
    fromPort: default
    toPort: default
  - id: b0c1d2e3-4f5a-6b7c-8d9e-0f1a2b3c4d5e
    from: a6f7b8c9-0d1e-2f3a-4b5c-6d7e8f9a0b1c
    to: c8b9d0e1-2f3a-4b5c-6d7e-8f9a0b1c2d3e
    fromPort: default
    toPort: default
  - id: f3a4b5c6-7d8e-9f0a-1b2c-3d4e5f6a7b8c
    from: b7a8c9d0-1e2f-3a4b-5c6d-7e8f9a0b1c2d
    to: e2f3a4b5-6c7d-8e9f-0a1b-2c3d4e5f6a7b
    fromPort: default
    toPort: default
  - id: c1d2e3f4-5a6b-7c8d-9e0f-1a2b3c4d5e6f
    from: c8b9d0e1-2f3a-4b5c-6d7e-8f9a0b1c2d3e
    to: d9c0e1f2-3a4b-5c6d-7e8f-9a0b1c2d3e4f
    fromPort: default
    toPort: default
  - id: d2e3f4a5-6b7c-8d9e-0f1a-2b3c4d5e6f7a
    from: d9c0e1f2-3a4b-5c6d-7e8f-9a0b1c2d3e4f
    to: 3f4e5d6c-7b8a-9c0d-1e2f-3a4b5c6d7e8f
    fromPort: default
    toPort: default
  - id: e1f2a3b4-5c6d-7e8f-9a0b-1c2d3e4f5a6b
    from: a5aefda5-b66f-4d20-b8b8-5b1aa322ec8e
    to: d3c4e5f6-7a8b-9c0d-1e2f-3a4b5c6d7e8f
    fromPort: lod2
    toPort: default
  - id: f2a3b4c5-6d7e-8f9a-0b1c-2d3e4f5a6b7c
    from: a5aefda5-b66f-4d20-b8b8-5b1aa322ec8e
    to: d3c4e5f6-7a8b-9c0d-1e2f-3a4b5c6d7e8f
    fromPort: lod3
    toPort: default
  - id: a3b4c5d6-7e8f-9a0b-1c2d-3e4f5a6b7c8d
    from: a5aefda5-b66f-4d20-b8b8-5b1aa322ec8e
    to: d3c4e5f6-7a8b-9c0d-1e2f-3a4b5c6d7e8f
    fromPort: lod4
    toPort: default
  ports:
    outputs:
    - id: errorCountLbldg02
      nodeId: e2f3a4b5-6c7d-8e9f-0a1b-2c3d4e5f6a7b
      port: default
    - id: errorCountLod01BuildingPart
      nodeId: 88d8e9f0-1a2b-3c4d-5e6f-7a8b9c0d1e2f
      port: default
    - id: fileOutput
      nodeId: 3f4e5d6c-7b8a-9c0d-1e2f-3a4b5c6d7e8f
      port: default
- id: 36d6a846-80a8-48e9-9c34-d7c0b8af2d6d
  name: FormatChecker
  nodes:
  - id: cbe26f1a-d39d-48e1-9d42-a9e0b61962ba
    name: InputRouter
    type: action
    action: InputRouter
    with:
      routingPort: default
  - id: 4a05d084-a43b-4b25-b252-c4fe5e047991
    name: GeometryRemoverForFormatChecks
    type: action
    action: GeometryRemover
  - id: 793ebebf-6903-4691-bed5-5913d3062a39
    name: SurfaceValidationC02
    type: action
    action: StatisticsCalculator
    with:
      groupBy:
      - gmlFilename
      calculations:
      - newAttribute: Building
        expr: |
          let feature_type = env.get("__value").featureType ?? "";
          if feature_type == "bldg:Building" {
            1
          } else {
            0
          }
      - newAttribute: BuildingPart
        expr: |
          let feature_type = env.get("__value").featureType ?? "";
          if feature_type == "bldg:BuildingPart" {
            1
          } else {
            0
          }
      - newAttribute: RoofSurface
        expr: |
          let feature_type = env.get("__value").featureType ?? "";
          if feature_type == "bldg:RoofSurface" {
            1
          } else {
            0
          }
      - newAttribute: GroundSurface
        expr: |
          let feature_type = env.get("__value").featureType ?? "";
          if feature_type == "bldg:GroundSurface" {
            1
          } else {
            0
          }
      - newAttribute: WallSurface
        expr: |
          let feature_type = env.get("__value").featureType ?? "";
          if feature_type == "bldg:WallSurface" {
            1
          } else {
            0
          }
      - newAttribute: ClosureSurface
        expr: |
          let feature_type = env.get("__value").featureType ?? "";
          if feature_type == "bldg:ClosureSurface" {
            1
          } else {
            0
          }
      - newAttribute: OuterCeilingSurface
        expr: |
          let feature_type = env.get("__value").featureType ?? "";
          if feature_type == "bldg:OuterCeilingSurface" {
            1
          } else {
            0
          }
      - newAttribute: OuterFloorSurface
        expr: |
          let feature_type = env.get("__value").featureType ?? "";
          if feature_type == "bldg:OuterFloorSurface" {
            1
          } else {
            0
          }
      - newAttribute: BuildingInstallation
        expr: |
          let feature_type = env.get("__value").featureType ?? "";
          if feature_type == "bldg:BuildingInstallation" {
            1
          } else {
            0
          }
      - newAttribute: Door
        expr: |
          let feature_type = env.get("__value").featureType ?? "";
          if feature_type == "bldg:Door" {
            1
          } else {
            0
          }
      - newAttribute: Window
        expr: |
          let feature_type = env.get("__value").featureType ?? "";
          if feature_type == "bldg:Window" {
            1
          } else {
            0
          }
      - newAttribute: Room
        expr: |
          let feature_type = env.get("__value").featureType ?? "";
          if feature_type == "bldg:Room" {
            1
          } else {
            0
          }
      - newAttribute: InteriorWallSurface
        expr: |
          let feature_type = env.get("__value").featureType ?? "";
          if feature_type == "bldg:InteriorWallSurface" {
            1
          } else {
            0
          }
      - newAttribute: CeilingSurface
        expr: |
          let feature_type = env.get("__value").featureType ?? "";
          if feature_type == "bldg:CeilingSurface" {
            1
          } else {
            0
          }
      - newAttribute: FloorSurface
        expr: |
          let feature_type = env.get("__value").featureType ?? "";
          if feature_type == "bldg:FloorSurface" {
            1
          } else {
            0
          }
      - newAttribute: IntBuildingInstallation
        expr: |
          let feature_type = env.get("__value").featureType ?? "";
          if feature_type == "bldg:IntBuildingInstallation" {
            1
          } else {
            0
          }
      - newAttribute: BuildingFurniture
        expr: |
          let feature_type = env.get("__value").featureType ?? "";
          if feature_type == "bldg:BuildingFurniture" {
            1
          } else {
            0
          }
  - id: 88e7f8a9-0b1c-2d3e-4f5a-6b7c8d9e0f1a
    name: AttributeManagerC02
    type: action
    action: AttributeManager
    with:
      operations:
      - attribute: gmlFilename
        method: remove
  - id: 7debf320-37c4-414e-acab-9f2fb41e2848
    name: FileTSVWriterC02
    type: action
    action: FeatureWriter
    with:
      format: csv
      output: |
        file::join_path(env.get("workerArtifactPath") ?? env.get("outputPath"), "02_建築物_地物インスタンス数.csv")
  - id: 80b7d9fd-6514-49d0-88e6-a87c3c1d36c9
    name: FeatureFilterBuildingAndBuildingPart
    type: action
    action: FeatureFilter
    with:
      conditions:
      - expr: |
          env.get("__value")["gmlName"] == "bldg:Building" || env.get("__value")["gmlName"] == "bldg:BuildingPart"
        outputPort: default
  - id: b942f28a-3783-4672-8196-f124e8cc5f51
    name: BuildingUsageAttributeValidator
    type: action
    action: PLATEAU4.BuildingUsageAttributeValidator
  - id: 8f2a1b3c-4d5e-6f7a-8b9c-0d1e2f3a4b5c
    name: AttributeMapper-l-bldg-04-05-transform
    type: action
    action: AttributeMapper
    with:
      mappers:
      - attribute: Filename
        expr: |
          env.get("__value").gmlFilename
      - attribute: Index
        expr: |
          env.get("__value").fileIndex
      - attribute: gml_id
        expr: |
          env.get("__value").gmlId
      - attribute: Building Usage Attribute Error
        expr: |
          env.get("__value").errors
      - attribute: Feature Type
        expr: |
          env.get("__value").featureType
  - id: 72b70428-0bb9-401b-a295-881556adc526
    name: FileTSVWriterLBDLG04-05
    type: action
    action: FeatureWriter
    with:
      format: csv
      output: |
        file::join_path(env.get("workerArtifactPath") ?? env.get("outputPath"), "02_建築物_L-bldg-04,05エラー.csv")
  - id: 5d8e7f4a-3b2c-4f1e-9a8d-6c5b4e3f2a1b
    name: AttributeMapper-city-code-error-transform
    type: action
    action: AttributeMapper
    with:
      mappers:
      - attribute: Filename
        expr: |
          env.get("__value").gmlFilename
      - attribute: Index
        expr: |
          env.get("__value").fileIndex
      - attribute: gml_id
        expr: |
          env.get("__value").gmlId
      - attribute: City Code Error
        expr: |
          env.get("__value").cityCodeError
      - attribute: Feature Type
        expr: |
          env.get("__value").featureType
  - id: ab3505ad-4e89-4442-ab36-c52ac29c332e
    name: FileTSVWriterCityCodeError
    type: action
    action: FeatureWriter
    with:
      format: csv
      output: |
        file::join_path(env.get("workerArtifactPath") ?? env.get("outputPath"), "02_建築物_市区町村コードエラー.csv")
  - id: 33c1a2b3-4d5e-6f7a-8b9c-0d1e2f3a4b5c
    name: CityCodeErrorCounter
    type: action
    action: StatisticsCalculator
    with:
      groupBy:
      - gmlFilename
      calculations:
      - newAttribute: _num_incorrect_city_code
        expr: '1'
  - id: 44d2b3c4-5e6f-7a8b-9c0d-1e2f3a4b5c6d
    name: ErrorCount-CityCode
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountCityCode
  - id: 55e3c4d5-6f7a-8b9c-0d1e-2f3a4b5c6d7e
    name: L0405BldgErrorCounter
    type: action
    action: StatisticsCalculator
    with:
      groupBy:
      - gmlFilename
      calculations:
      - newAttribute: _num_incorrect_usage_attribute
        expr: '1'
  - id: 66f4d5e6-7a8b-9c0d-1e2f-3a4b5c6d7e8f
    name: ErrorCount-L0405Bldg
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountL0405Bldg
  - id: 1a2b3c4d-5e6f-7a8b-9c0d-1e2f3a4b5c6d
    name: FeatureFilterValidBuildingIds
    type: action
    action: FeatureFilter
    with:
      conditions:
      - expr: |
          let attributes = env.get("__value").cityGmlAttributes ?? #{};
          let building_id_attribute = (attributes["uro:BuildingIDAttribute"] ?? []).get(0) ?? #{};
          let building_id = building_id_attribute["uro:buildingID"] ?? "";
          let branch_id = building_id_attribute["uro:branchID"]  ?? "";
          let part_id = building_id_attribute["uro:partID"] ?? "";
          let gml_name = env.get("__value").gmlName ?? "";

          // Condition 1: buildingID matches regex ^\d{5}-bldg-\d+$
          let building_id_valid = str::matches(building_id, `^\d{5}-bldg-\d+$`);

          // Condition 2: branchID is missing or integer type
          let branch_id_valid = branch_id == "" || type_of(branch_id) == "i64";

          // Condition 3: Building with missing partID, or BuildingPart with integer partID
          let part_id_valid = false;
          if gml_name == "bldg:Building" {
              part_id_valid = part_id == "";
          } else if gml_name == "bldg:BuildingPart" {
              part_id_valid = type_of(part_id) == "i64";
          }

          building_id_valid && branch_id_valid && part_id_valid
        outputPort: goodUroFormatting
  - id: 3b4c5d6e-7f8a-9b0c-1d2e-3f4a5b6c7d8e
    name: AttributeMapper-invalid-building-id-format
    type: action
    action: AttributeMapper
    with:
      mappers:
      - attribute: Index
        expr: |
          env.get("__value").fileIndex
      - attribute: Filename
        expr: |
          env.get("__value").gmlFilename
      - attribute: FeatureType
        expr: |
          env.get("__value").gmlName
      - attribute: uro:buildingID
        expr: |
          let attributes = env.get("__value").cityGmlAttributes ?? #{};
          let building_id_attribute = (attributes["uro:BuildingIDAttribute"] ?? []).get(0) ?? #{};
          building_id_attribute["uro:buildingID"] ?? ""
      - attribute: uro:branchID
        expr: |
          let attributes = env.get("__value").cityGmlAttributes ?? #{};
          let building_id_attribute = (attributes["uro:BuildingIDAttribute"] ?? []).get(0) ?? #{};
          building_id_attribute["uro:branchID"] ?? "（なし）"
      - attribute: uro:partID
        expr: |
          let attributes = env.get("__value").cityGmlAttributes ?? #{};
          let building_id_attribute = (attributes["uro:BuildingIDAttribute"] ?? []).get(0) ?? #{};
          building_id_attribute["uro:partID"] ?? "（なし）"
  - id: 4c5d6e7f-8a9b-0c1d-2e3f-4a5b6c7d8e9f
    name: FeatureWriter-invalid-building-id-format
    type: action
    action: FeatureWriter
    with:
      format: csv
      output: |
        file::join_path(env.get("workerArtifactPath") ?? env.get("outputPath"), "02_建築物_建物ID書式不正.csv")
  - id: 0b291ad6-cdfa-4371-bcbb-3422b2cd53cf
    name: AttributeAggregator-c-bldg-01
    type: action
    action: AttributeAggregator
    with:
      aggregateAttributes:
      - newAttribute: uroBuildingId
        attributeValue: |
          let attributes = env.get("__value").cityGmlAttributes ?? #{};
          let building_id_attribute = (attributes["uro:BuildingIDAttribute"] ?? []).get(0) ?? #{};
          building_id_attribute["uro:buildingID"] ?? ""
      - newAttribute: uroBranchId
        attributeValue: |
          let attributes = env.get("__value").cityGmlAttributes ?? #{};
          let building_id_attribute = (attributes["uro:BuildingIDAttribute"] ?? []).get(0) ?? #{};
          building_id_attribute["uro:branchID"] ?? ""
      - newAttribute: uroPartId
        attributeValue: |
          let attributes = env.get("__value").cityGmlAttributes ?? #{};
          let building_id_attribute = (attributes["uro:BuildingIDAttribute"] ?? []).get(0) ?? #{};
          building_id_attribute["uro:partID"] ?? ""
      calculation: |
        1
      calculationAttribute: |
        uroBuildingIdCount
      method: count
  - id: 9feabfe5-44eb-43c9-a892-ca439a0c0562
    name: FeatureMerger-c-bldg-01
    type: action
    action: FeatureMerger
    with:
      requestorAttributeValue: |
        let attributes = env.get("__value").cityGmlAttributes ?? #{};
        let building_id_attribute = (attributes["uro:BuildingIDAttribute"] ?? []).get(0) ?? #{};
        (building_id_attribute["uro:buildingID"] ?? "") + "-" + (building_id_attribute["uro:branchID"] ?? "") + "-" + (building_id_attribute["uro:partID"] ?? "")
      supplierAttributeValue: |
        (env.get("__value").uroBuildingId ?? "") + "-" + (env.get("__value").uroBranchId ?? "") + "-" + (env.get("__value").uroPartId ?? "")
  - id: f003fa53-d8da-488b-9be2-9f871a7394b5
    name: FeatureFilterByMultipleBuildingId-c-bldg-01
    type: action
    action: FeatureFilter
    with:
      conditions:
      - expr: |
          env.get("__value").uroBuildingIdCount > 1
        outputPort: multipleBuildingId
  - id: b6238f2d-e1d3-497b-a632-93d9d489ccfc
    name: AttributeMapper-c-bldg-01
    type: action
    action: AttributeMapper
    with:
      mappers:
      - attribute: Index
        expr: |
          env.get("__value").fileIndex
      - attribute: Filename
        expr: |
          env.get("__value").gmlFilename
      - attribute: GmlId
        expr: |
          env.get("__value").gmlId
      - attribute: UroBuildingId
        expr: |
          let city_gml_attrs = env.get("__value").cityGmlAttributes ?? #{};
          let bldg_id_attr = (city_gml_attrs["uro:BuildingIDAttribute"] ?? []).get(0) ?? #{};
          bldg_id_attr["uro:buildingID"] ?? ""
      - attribute: UroBranchId
        expr: |
          let city_gml_attrs = env.get("__value").cityGmlAttributes ?? #{};
          let bldg_id_attr = (city_gml_attrs["uro:BuildingIDAttribute"] ?? []).get(0) ?? #{};
          let branch_id = bldg_id_attr["uro:branchID"] ?? "";
          if (branch_id == "") {
            "（なし）"
          } else {
            branch_id
          }
      - attribute: UroPartId
        expr: |
          let city_gml_attrs = env.get("__value").cityGmlAttributes ?? #{};
          let bldg_id_attr = (city_gml_attrs["uro:BuildingIDAttribute"] ?? []).get(0) ?? #{};
          let part_id = bldg_id_attr["uro:partID"] ?? "";
          if (part_id == "") {
            "（なし）"
          } else {
            part_id
          }
  - id: bba483d0-9813-499e-a0f6-22874646450d
    name: FeatureWriterCsv-c-bldg-01
    type: action
    action: FeatureWriter
    with:
      format: csv
      output: |
        file::join_path(env.get("workerArtifactPath") ?? env.get("outputPath"), "02_建築物_C-bldg-01エラー.csv")
  - id: 124b1896-04c2-41d9-9e76-0ce32b04089f
    name: C-BLDG-01ErrorCounter
    type: action
    action: StatisticsCalculator
    with:
      groupBy:
      - gmlFilename
      calculations:
      - newAttribute: _num_duplicate_building_id
        expr: '1'
  - id: aa7d7462-2b7f-472f-a381-90bc3cdba432
    name: ErrorCount-C-BLDG-01
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountCBldg01
  - id: 77a5e6f7-8b9c-0d1e-2f3a-4b5c6d7e8f9a
    name: MissingBuildingIdErrorCounter
    type: action
    action: StatisticsCalculator
    with:
      groupBy:
      - gmlFilename
      calculations:
      - newAttribute: _num_missing_building_id
        expr: '1'
  - id: 88b6f7a8-9c0d-1e2f-3a4b-5c6d7e8f9a0b
    name: ErrorCount-MissingBuildingId
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountMissingBuildingId
  - id: 99c7d8e9-0f1a-2b3c-4d5e-6f7a8b9c0d1e
    name: FeatureInstanceCount-C02
    type: action
    action: OutputRouter
    with:
      routingPort: featureInstanceCountC02
  - id: 9a0b1c2d-3e4f-5a6b-7c8d-9e0f1a2b3c4d
    name: FileOutputRouter
    type: action
    action: OutputRouter
    with:
      routingPort: fileOutput
  edges:
  - id: 1acf360f-3edb-435c-b6fd-0f233bbd999b
    from: cbe26f1a-d39d-48e1-9d42-a9e0b61962ba
    fromPort: default
    to: 4a05d084-a43b-4b25-b252-c4fe5e047991
    toPort: default
  - id: 63110e28-8d45-46a7-afa8-8a1877d1739a
    from: 4a05d084-a43b-4b25-b252-c4fe5e047991
    fromPort: default
    to: 793ebebf-6903-4691-bed5-5913d3062a39
    toPort: default
  - id: 1ba43f25-e4b1-42a5-ab0d-732380a7124c
    from: 793ebebf-6903-4691-bed5-5913d3062a39
    fromPort: default
    to: 88e7f8a9-0b1c-2d3e-4f5a-6b7c8d9e0f1a
    toPort: default
  - id: 77b6c7d8-9e0f-1a2b-3c4d-5e6f7a8b9c0d
    from: 88e7f8a9-0b1c-2d3e-4f5a-6b7c8d9e0f1a
    fromPort: default
    to: 7debf320-37c4-414e-acab-9f2fb41e2848
    toPort: default
  - id: 88d8e9f0-1a2b-3c4d-5e6f-7a8b9c0d1e2f
    from: 793ebebf-6903-4691-bed5-5913d3062a39
    fromPort: default
    to: 99c7d8e9-0f1a-2b3c-4d5e-6f7a8b9c0d1e
    toPort: default
  - id: 6546098c-dca0-4a81-8342-c993c28d36f6
    from: 4a05d084-a43b-4b25-b252-c4fe5e047991
    fromPort: default
    to: 80b7d9fd-6514-49d0-88e6-a87c3c1d36c9
    toPort: default
  - id: 8ac73cfb-7496-462b-a9fb-e42f81dbb198
    from: 80b7d9fd-6514-49d0-88e6-a87c3c1d36c9
    fromPort: default
    to: b942f28a-3783-4672-8196-f124e8cc5f51
    toPort: default
  - id: 452c80b4-97e5-48f3-a6fc-80630b9a7f17
    from: b942f28a-3783-4672-8196-f124e8cc5f51
    fromPort: l0405BldgError
    to: 8f2a1b3c-4d5e-6f7a-8b9c-0d1e2f3a4b5c
    toPort: default
  - id: 9e8d7c6b-5a4f-3e2d-1c0b-9a8e7f6d5c4b
    from: 8f2a1b3c-4d5e-6f7a-8b9c-0d1e2f3a4b5c
    fromPort: default
    to: 72b70428-0bb9-401b-a295-881556adc526
    toPort: default
  - id: 9b8fd1b8-4f51-48f7-b727-933626555fd7
    from: b942f28a-3783-4672-8196-f124e8cc5f51
    fromPort: cityCodeError
    to: 5d8e7f4a-3b2c-4f1e-9a8d-6c5b4e3f2a1b
    toPort: default
  - id: 2c4e5f1a-8b9d-4a7e-9c2f-5e8d6a4b1c3f
    from: 5d8e7f4a-3b2c-4f1e-9a8d-6c5b4e3f2a1b
    fromPort: default
    to: ab3505ad-4e89-4442-ab36-c52ac29c332e
    toPort: default
  - id: 11a1b2c3-4d5e-6f7a-8b9c-0d1e2f3a4b5c
    from: b942f28a-3783-4672-8196-f124e8cc5f51
    fromPort: cityCodeError
    to: 33c1a2b3-4d5e-6f7a-8b9c-0d1e2f3a4b5c
    toPort: default
  - id: 22b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d
    from: 33c1a2b3-4d5e-6f7a-8b9c-0d1e2f3a4b5c
    fromPort: default
    to: 44d2b3c4-5e6f-7a8b-9c0d-1e2f3a4b5c6d
    toPort: default
  - id: 33c3d4e5-6f7a-8b9c-0d1e-2f3a4b5c6d7e
    from: b942f28a-3783-4672-8196-f124e8cc5f51
    fromPort: l0405BldgError
    to: 55e3c4d5-6f7a-8b9c-0d1e-2f3a4b5c6d7e
    toPort: default
  - id: 44d4e5f6-7a8b-9c0d-1e2f-3a4b5c6d7e8f
    from: 55e3c4d5-6f7a-8b9c-0d1e-2f3a4b5c6d7e
    fromPort: default
    to: 66f4d5e6-7a8b-9c0d-1e2f-3a4b5c6d7e8f
    toPort: default
  - id: 5a6a854c-8778-4c58-aa9c-f3f87635a569
    from: 80b7d9fd-6514-49d0-88e6-a87c3c1d36c9
    fromPort: default
    to: 1a2b3c4d-5e6f-7a8b-9c0d-1e2f3a4b5c6d
    toPort: default
  - id: 2f3a4b5c-6d7e-8f9a-0b1c-2d3e4f5a6b7c
    from: 1a2b3c4d-5e6f-7a8b-9c0d-1e2f3a4b5c6d
    fromPort: goodUroFormatting
    to: 0b291ad6-cdfa-4371-bcbb-3422b2cd53cf
    toPort: default
  - id: 5e6f7a8b-9c0d-1e2f-3a4b-5c6d7e8f9a0b
    from: 1a2b3c4d-5e6f-7a8b-9c0d-1e2f3a4b5c6d
    fromPort: unfiltered
    to: 3b4c5d6e-7f8a-9b0c-1d2e-3f4a5b6c7d8e
    toPort: default
  - id: 6f7a8b9c-0d1e-2f3a-4b5c-6d7e8f9a0b1c
    from: 3b4c5d6e-7f8a-9b0c-1d2e-3f4a5b6c7d8e
    fromPort: default
    to: 4c5d6e7f-8a9b-0c1d-2e3f-4a5b6c7d8e9f
    toPort: default
  - id: 62d508e6-0c0d-45c5-8322-5369e50b693c
    from: 1a2b3c4d-5e6f-7a8b-9c0d-1e2f3a4b5c6d
    fromPort: goodUroFormatting
    to: 9feabfe5-44eb-43c9-a892-ca439a0c0562
    toPort: requestor
  - id: e4dff82e-7c9f-469d-b60f-eee0afa28405
    from: 0b291ad6-cdfa-4371-bcbb-3422b2cd53cf
    fromPort: default
    to: 9feabfe5-44eb-43c9-a892-ca439a0c0562
    toPort: supplier
  - id: 0a83d16c-30e0-4ea3-86fa-c7794641a0d6
    from: 9feabfe5-44eb-43c9-a892-ca439a0c0562
    fromPort: merged
    to: f003fa53-d8da-488b-9be2-9f871a7394b5
    toPort: default
  - id: cfd17a81-3251-43d3-b161-8499ec64eadf
    from: f003fa53-d8da-488b-9be2-9f871a7394b5
    fromPort: multipleBuildingId
    to: b6238f2d-e1d3-497b-a632-93d9d489ccfc
    toPort: default
  - id: d0341071-8164-480f-bad5-73caeec1dc22
    from: b6238f2d-e1d3-497b-a632-93d9d489ccfc
    fromPort: default
    to: bba483d0-9813-499e-a0f6-22874646450d
    toPort: default
  - id: 174aea4f-a7a9-4dee-8b6d-b7eb2234a4ce
    from: f003fa53-d8da-488b-9be2-9f871a7394b5
    fromPort: multipleBuildingId
    to: 124b1896-04c2-41d9-9e76-0ce32b04089f
    toPort: default
  - id: ccc937ca-4311-4c80-a30b-e8939d70c23c
    from: 124b1896-04c2-41d9-9e76-0ce32b04089f
    fromPort: default
    to: aa7d7462-2b7f-472f-a381-90bc3cdba432
    toPort: default
  - id: 55e5f6a7-8b9c-0d1e-2f3a-4b5c6d7e8f9a
    from: 1a2b3c4d-5e6f-7a8b-9c0d-1e2f3a4b5c6d
    fromPort: unfiltered
    to: 77a5e6f7-8b9c-0d1e-2f3a-4b5c6d7e8f9a
    toPort: default
  - id: 66f6a7b8-9c0d-1e2f-3a4b-5c6d7e8f9a0b
    from: 77a5e6f7-8b9c-0d1e-2f3a-4b5c6d7e8f9a
    fromPort: default
    to: 88b6f7a8-9c0d-1e2f-3a4b-5c6d7e8f9a0b
    toPort: default
  - id: 0a1b2c3d-4e5f-6a7b-8c9d-0e1f2a3b4c5d
    from: 7debf320-37c4-414e-acab-9f2fb41e2848
    fromPort: default
    to: 9a0b1c2d-3e4f-5a6b-7c8d-9e0f1a2b3c4d
    toPort: default
  - id: 1b2c3d4e-5f6a-7b8c-9d0e-1f2a3b4c5d6e
    from: 72b70428-0bb9-401b-a295-881556adc526
    fromPort: default
    to: 9a0b1c2d-3e4f-5a6b-7c8d-9e0f1a2b3c4d
    toPort: default
  - id: 2c3d4e5f-6a7b-8c9d-0e1f-2a3b4c5d6e7f
    from: ab3505ad-4e89-4442-ab36-c52ac29c332e
    fromPort: default
    to: 9a0b1c2d-3e4f-5a6b-7c8d-9e0f1a2b3c4d
    toPort: default
  - id: 3d4e5f6a-7b8c-9d0e-1f2a-3b4c5d6e7f8a
    from: 4c5d6e7f-8a9b-0c1d-2e3f-4a5b6c7d8e9f
    fromPort: default
    to: 9a0b1c2d-3e4f-5a6b-7c8d-9e0f1a2b3c4d
    toPort: default
  - id: 4e5f6a7b-8c9d-0e1f-2a3b-4c5d6e7f8a9b
    from: bba483d0-9813-499e-a0f6-22874646450d
    fromPort: default
    to: 9a0b1c2d-3e4f-5a6b-7c8d-9e0f1a2b3c4d
    toPort: default
  ports:
    outputs:
    - id: featureInstanceCountC02
      nodeId: 99c7d8e9-0f1a-2b3c-4d5e-6f7a8b9c0d1e
      port: default
    - id: errorCountCityCode
      nodeId: 44d2b3c4-5e6f-7a8b-9c0d-1e2f3a4b5c6d
      port: default
    - id: errorCountL0405Bldg
      nodeId: 66f4d5e6-7a8b-9c0d-1e2f-3a4b5c6d7e8f
      port: default
    - id: errorCountCBldg01
      nodeId: aa7d7462-2b7f-472f-a381-90bc3cdba432
      port: default
    - id: errorCountMissingBuildingId
      nodeId: 88b6f7a8-9c0d-1e2f-3a4b-5c6d7e8f9a0b
      port: default
    - id: fileOutput
      nodeId: 9a0b1c2d-3e4f-5a6b-7c8d-9e0f1a2b3c4d
      port: default
- id: 34e55bec-9185-4a66-9c41-3dbddc1e64fa
  name: ReferenceAndTypeChecker
  nodes:
  - id: ab309f69-4758-491b-831c-75ea5c0f05fe
    name: InputRouter
    type: action
    action: InputRouter
    with:
      routingPort: default
  - id: 911ebdb1-a05e-48f4-a208-c0653f1f1731
    name: UnmatchedXlinkDetector
    type: action
    action: PLATEAU4.UnmatchedXlinkDetector
    with:
      attribute: gmlPath
  - id: 691a328a-f39b-403e-b62f-7525771b6f14
    name: L-bldg-Summary
    type: action
    action: NoopSink
  - id: 88c90fea-04d6-4e54-8ab1-4dc6386f6699
    name: AttributeManagerFrom
    type: action
    action: AttributeManager
    with:
      operations:
      - attribute: Attribute
        method: create
        value: |
          "参照元 xlink:href"
      - attribute: unmatchedXlinkFromTag
        method: rename
        value: unmatchedXlinkTag
      - attribute: unmatchedXlinkFromId
        method: rename
        value: unmatchedXlinkId
  - id: 2d024ca7-cb00-47bb-aa50-12a395a6c8b8
    name: AttributeManagerTo
    type: action
    action: AttributeManager
    with:
      operations:
      - attribute: Attribute
        method: create
        value: |
          "参照先 gml:id"
      - attribute: unmatchedXlinkToTag
        method: rename
        value: unmatchedXlinkTag
      - attribute: unmatchedXlinkToId
        method: rename
        value: unmatchedXlinkId
  - id: 7c7dd820-2c7e-4e79-ab3f-1566fc4bd2ca
    name: AttributeMapperL-bldg-06
    type: action
    action: AttributeMapper
    with:
      mappers:
      - attribute: Index
        expr: |
          env.get("__value").fileIndex
      - attribute: Filename
        expr: |
          file::extract_filename(env.get("__value").gmlPath)
      - attribute: gmlFilename
        expr: |
          file::extract_filename(env.get("__value").gmlPath)
      - attribute: Building gml:id
        expr: |
          env.get("__value").gmlId
      - attribute: Unmatched Xlink Tag
        expr: |
          collection::join_array((env.get("__value").unmatchedXlinkTag ?? []), ",")
      - attribute: Attribute
        expr: |
          env.get("__value").Attribute
      - attribute: Unmatched Xlink ID
        expr: |
          collection::join_array((env.get("__value").unmatchedXlinkId ?? []), ",")
  - id: 99d8e9f0-1a2b-3c4d-5e6f-7a8b9c0d1e2f
    name: AttributeManagerLbldg06
    type: action
    action: AttributeManager
    with:
      operations:
      - attribute: gmlFilename
        method: remove
  - id: adba8857-9de2-43bd-8cde-b83bc08a58f6
    name: FileWriterTsvL-bldg-06
    type: action
    action: FeatureWriter
    with:
      format: csv
      output: |
        file::join_path(env.get("workerArtifactPath") ?? env.get("outputPath"), "02_建築物_L-bldg-06エラー.csv")
  - id: 77a1b2c3-4d5e-6f7a-8b9c-0d1e2f3a4b5c
    name: Lbldg06ErrorCounter
    type: action
    action: StatisticsCalculator
    with:
      groupBy:
      - gmlFilename
      calculations:
      - newAttribute: _num_lbldg06_error
        expr: '1'
  - id: 88b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d
    name: ErrorCount-Lbldg06
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLbldg06
  - id: 1c480edd-fa61-4b43-b851-8cfc560f5859
    name: BuildingInstallationGeometryTypeChecker
    type: action
    action: PLATEAU4.BuildingInstallationGeometryTypeChecker
  - id: 690f9475-1821-4f50-8315-f00f53251a00
    name: FeatureFilterByBuildingInstallationGeometryType
    type: action
    action: FeatureFilter
    with:
      conditions:
      - expr: |
          !(env.get("__value").geomTag in ["gml:MultiSurface", "gml:Solid"])
        outputPort: default
  - id: 38b305d1-d716-48da-b578-419e15f66b4b
    name: AttributeMapperT-bldg-02
    type: action
    action: AttributeMapper
    with:
      mappers:
      - attribute: Index
        expr: |
          env.get("__value").fileIndex
      - attribute: Filename
        expr: |
          file::extract_filename(env.get("__value").gmlPath)
      - attribute: Building gml:id
        expr: |
          env.get("__value").bldgGmlId
      - attribute: BuildingInstallation gml:id
        expr: |
          env.get("__value").instGmlId
      - attribute: GeometryType
        expr: |
          env.get("__value").geomTag
  - id: 2bae2659-e981-4eb1-8cbe-ce0352584a10
    name: FileWriterTsvT-bldg-02
    type: action
    action: FeatureWriter
    with:
      format: csv
      output: |
        file::join_path(env.get("workerArtifactPath") ?? env.get("outputPath"), "02_建築物_T-bldg-02エラー.csv")
  - id: 35e0e6d2-44f4-4e75-abce-5280c2b80a5d
    name: StatisticsCalculatorT-bldg-02
    type: action
    action: StatisticsCalculator
    with:
      groupBy:
      - cityGmlPath
      calculations:
      - newAttribute: instGmlIdTotalCount
        expr: |
          let gml_id = env.get("__value").instGmlId ?? "";
          if gml_id != "" {
            1
          } else {
            0
          }
  - id: 630081e4-0ea1-4fd3-ba31-8154b2980258
    name: NoopT-bldg-02
    type: action
    action: NoopSink
  - id: 99a1b2c3-4d5e-6f7a-8b9c-0d1e2f3a4b5c
    name: InvalidBldgInstGeomTypeCounter
    type: action
    action: StatisticsCalculator
    with:
      groupBy:
      - gmlFilename
      calculations:
      - newAttribute: _num_invalid_bldginst_geom_type
        expr: '1'
  - id: 88d2c3e4-5f6a-7b8c-9d0e-1f2a3b4c5d6e
    name: ErrorCount-InvalidBldgInstGeomType
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountInvalidBldgInstGeomType
  - id: aab0c1d2-3e4f-5a6b-7c8d-9e0f1a2b3c4d
    name: FileOutputRouter
    type: action
    action: OutputRouter
    with:
      routingPort: fileOutput
  edges:
  - id: 93431d4e-fcd2-4308-af3c-9da9441ac911
    from: ab309f69-4758-491b-831c-75ea5c0f05fe
    to: 911ebdb1-a05e-48f4-a208-c0653f1f1731
    fromPort: default
    toPort: default
  - id: 6941c617-dc23-4aa9-b794-b7d409212ccb
    from: 911ebdb1-a05e-48f4-a208-c0653f1f1731
    to: 691a328a-f39b-403e-b62f-7525771b6f14
    fromPort: summary
    toPort: default
  - id: abcb0569-faf7-4317-80d8-fb80a0e5b0d7
    from: 911ebdb1-a05e-48f4-a208-c0653f1f1731
    to: 88c90fea-04d6-4e54-8ab1-4dc6386f6699
    fromPort: unMatchedXlinkFrom
    toPort: default
  - id: 9830a9fb-73ed-42c2-b2eb-c2315560ae49
    from: 911ebdb1-a05e-48f4-a208-c0653f1f1731
    to: 2d024ca7-cb00-47bb-aa50-12a395a6c8b8
    fromPort: unMatchedXlinkTo
    toPort: default
  - id: 6e42817f-c316-40d0-b972-17ad2409a350
    from: 88c90fea-04d6-4e54-8ab1-4dc6386f6699
    to: 7c7dd820-2c7e-4e79-ab3f-1566fc4bd2ca
    fromPort: default
    toPort: default
  - id: 59fcfbd3-9e08-4117-bd5d-43854c6af81f
    from: 2d024ca7-cb00-47bb-aa50-12a395a6c8b8
    to: 7c7dd820-2c7e-4e79-ab3f-1566fc4bd2ca
    fromPort: default
    toPort: default
  - id: f398a1bc-8dc3-4b14-a971-3e765afea9ef
    from: 7c7dd820-2c7e-4e79-ab3f-1566fc4bd2ca
    to: 99d8e9f0-1a2b-3c4d-5e6f-7a8b9c0d1e2f
    fromPort: default
    toPort: default
  - id: 88e8f9a0-1b2c-3d4e-5f6a-7b8c9d0e1f2a
    from: 99d8e9f0-1a2b-3c4d-5e6f-7a8b9c0d1e2f
    to: adba8857-9de2-43bd-8cde-b83bc08a58f6
    fromPort: default
    toPort: default
  - id: 55a1b2c3-4d5e-6f7a-8b9c-0d1e2f3a4b5c
    from: 7c7dd820-2c7e-4e79-ab3f-1566fc4bd2ca
    to: 77a1b2c3-4d5e-6f7a-8b9c-0d1e2f3a4b5c
    fromPort: default
    toPort: default
  - id: 66b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d
    from: 77a1b2c3-4d5e-6f7a-8b9c-0d1e2f3a4b5c
    fromPort: default
    to: 88b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d
    toPort: default
  - id: 50c97ada-42ba-494e-a844-d3256f998a60
    from: ab309f69-4758-491b-831c-75ea5c0f05fe
    to: 1c480edd-fa61-4b43-b851-8cfc560f5859
    fromPort: default
    toPort: default
  - id: 9ac13613-ccca-42fd-afd1-77fa2635e288
    from: 1c480edd-fa61-4b43-b851-8cfc560f5859
    to: 690f9475-1821-4f50-8315-f00f53251a00
    fromPort: default
    toPort: default
  - id: c79def35-473d-406a-8478-0335aa9ae4c1
    from: 690f9475-1821-4f50-8315-f00f53251a00
    to: 38b305d1-d716-48da-b578-419e15f66b4b
    fromPort: default
    toPort: default
  - id: 4205ee4c-4a1b-4628-b602-6127b994a8a0
    from: 38b305d1-d716-48da-b578-419e15f66b4b
    to: 2bae2659-e981-4eb1-8cbe-ce0352584a10
    fromPort: default
    toPort: default
  - id: ddac9d6a-fe63-4bf2-a640-5e2a541176a2
    from: 690f9475-1821-4f50-8315-f00f53251a00
    to: 35e0e6d2-44f4-4e75-abce-5280c2b80a5d
    fromPort: default
    toPort: default
  - id: ad6ddebd-4302-46f1-8df7-1358be238470
    from: 35e0e6d2-44f4-4e75-abce-5280c2b80a5d
    to: 630081e4-0ea1-4fd3-ba31-8154b2980258
    fromPort: default
    toPort: default
  - id: 77a7b8c9-0d1e-2f3a-4b5c-6d7e8f9a0b1c
    from: 690f9475-1821-4f50-8315-f00f53251a00
    fromPort: default
    to: 99a1b2c3-4d5e-6f7a-8b9c-0d1e2f3a4b5c
    toPort: default
  - id: 66b6c7d8-9e0f-1a2b-3c4d-5e6f7a8b9c0d
    from: 99a1b2c3-4d5e-6f7a-8b9c-0d1e2f3a4b5c
    fromPort: default
    to: 88d2c3e4-5f6a-7b8c-9d0e-1f2a3b4c5d6e
    toPort: default
  - id: 0a1b2c3d-4e5f-6a7b-8c9d-0e1f2a3b4c5d
    from: adba8857-9de2-43bd-8cde-b83bc08a58f6
    fromPort: default
    to: aab0c1d2-3e4f-5a6b-7c8d-9e0f1a2b3c4d
    toPort: default
  - id: 1b2c3d4e-5f6a-7b8c-9d0e-1f2a3b4c5d6e
    from: 2bae2659-e981-4eb1-8cbe-ce0352584a10
    fromPort: default
    to: aab0c1d2-3e4f-5a6b-7c8d-9e0f1a2b3c4d
    toPort: default
  ports:
    outputs:
    - id: errorCountLbldg06
      nodeId: 88b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d
      port: default
    - id: errorCountInvalidBldgInstGeomType
      nodeId: 88d2c3e4-5f6a-7b8c-9d0e-1f2a3b4c5d6e
      port: default
    - id: fileOutput
      nodeId: aab0c1d2-3e4f-5a6b-7c8d-9e0f1a2b3c4d
      port: default
- id: a9952b0d-e085-4a0b-bb76-fa36b969c96b
  name: SurfaceValidation01
  nodes:
  - id: 1bdf9a1d-84f9-4218-b6cc-997c041d2e50
    name: InputRouter
    type: action
    action: InputRouter
    with:
      routingPort: default
  - id: 7891eb04-45d5-4188-8acb-3bb277a126b6
    name: PLATEAU3.LodSplitterWithDM
    type: subGraph
    subGraphId: 7e98d856-1438-4148-bdcb-91747ef2e405
  - id: 88995ed0-27b5-4e25-a955-978267c78814
    name: PLATEAU3.SurfaceValidator2D
    type: subGraph
    subGraphId: 8a5b1c9d-2e4f-4a3b-9c5d-1e6f8a2b4c7d
  - id: efc3cc9a-1def-4883-a45a-d75b40713e96
    name: AttributeMapperLod0InvalidSurface
    type: action
    action: AttributeMapper
    with:
      mappers:
      - attribute: filename
        expr: |
          env.get("__value").gmlFilename
      - attribute: feature_type
        expr: |
          env.get("__value").featureType
      - attribute: gml_id
        expr: |
          env.get("__value").gmlId
      - attribute: lod
        expr: |
          env.get("__value").lod
      - attribute: issue
        expr: |
          let value = env.get("__value");
          if value.validationResult?.details != () {
            return value.validationResult.details[0][0];
          }
          if "issue" in value {
            return value.issue;
          }
          "UnknownError"
  - id: c19d754d-bf4b-4d01-8c90-d1de1ee14c59
    name: FeatureWriterLod0IncorrectOrientation
    type: action
    action: FeatureWriter
    with:
      format: csv
      output: |
        file::join_path(env.get("workerArtifactPath") ?? env.get("outputPath"), "02_建築物_LOD0面の向きエラー.csv")
  - id: 3e5789e9-9567-401a-988a-8d2a3bf616ab
    name: Lod0IncorrectOrientationCounter
    type: action
    action: StatisticsCalculator
    with:
      groupBy:
      - gmlFilename
      calculations:
      - newAttribute: _num_lod0_incorrect_orientation
        expr: '1'
  - id: 80fec261-afa7-446c-a6a2-27c6f61a666f
    name: ErrorCount-Lod0IncorrectOrientation
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLod0IncorrectOrientation
  - id: 58a8524b-aabc-4f97-bd88-3a0d29bedfb5
    name: FeatureWriterLod0InvalidSurface
    type: action
    action: FeatureWriter
    with:
      format: csv
      output: |
        file::join_path(env.get("workerArtifactPath") ?? env.get("outputPath"), "02_建築物_LOD0面のエラー.csv")
  - id: 87efa888-d6e2-4261-a1ce-04fef784caf2
    name: Lod0InvalidSurfaceCounter
    type: action
    action: StatisticsCalculator
    with:
      groupBy:
      - gmlFilename
      calculations:
      - newAttribute: _num_lod0_invalid_surface
        expr: '1'
  - id: 66ca88b4-13cb-4635-af48-12cf1e8c0a4c
    name: ErrorCount-Lod0InvalidSurface
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLod0InvalidSurface
  - id: 54fdff9d-406a-4a88-8d83-1fb7503e2b51
    name: PLATEAU3.SurfaceValidator3D_LOD1
    type: subGraph
    subGraphId: 8a5b1c9d-2e4f-4a3b-9c5d-1e6f8a2b4c7d
  - id: 5eb5c234-a00e-4dc3-b7c5-7de14e75d428
    name: AttributeMapperLod1InvalidSurface
    type: action
    action: AttributeMapper
    with:
      mappers:
      - attribute: filename
        expr: |
          env.get("__value").gmlFilename
      - attribute: feature_type
        expr: |
          env.get("__value").featureType
      - attribute: gml_id
        expr: |
          env.get("__value").gmlId
      - attribute: lod
        expr: |
          env.get("__value").lod
      - attribute: issue
        expr: |
          let value = env.get("__value");
          if value.validationResult?.details != () {
            return value.validationResult.details[0][0];
          }
          if "issue" in value {
            return value.issue;
          }
          "UnknownError"
  - id: 6b8ca91f-12ea-4507-9f3f-d6b5bdc8ac56
    name: FeatureWriterLod1InvalidSurface
    type: action
    action: FeatureWriter
    with:
      format: csv
      output: |
        file::join_path(env.get("workerArtifactPath") ?? env.get("outputPath"), "02_建築物_LOD1境界面のエラー.csv")
  - id: 0997425f-664a-4e34-9b82-f3bcb74ef5c7
    name: Lod1InvalidSurfaceCounter
    type: action
    action: StatisticsCalculator
    with:
      groupBy:
      - gmlFilename
      calculations:
      - newAttribute: _num_lod1_invalid_surface
        expr: '1'
  - id: 71cc70f0-0812-4ccd-9659-139202d945d9
    name: ErrorCount-Lod1InvalidSurface
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLod1InvalidSurface
  - id: d71c31ad-1ecd-4829-b368-7e0c0c6bd431
    name: GeometryFilterSurfaceOrSolid
    type: action
    action: GeometryFilter
    with:
      filterType: geometryType
  - id: 644bf900-3de8-4431-a325-1ae51fa2499f
    name: PLATEAU3.SurfaceValidator3D_LOD2-4
    type: subGraph
    subGraphId: 8a5b1c9d-2e4f-4a3b-9c5d-1e6f8a2b4c7d
  - id: 4804c5a8-3a6e-4e5d-ad3c-52149c8b5aa9
    name: Lod2-4InvalidSurfaceCounter
    type: action
    action: StatisticsCalculator
    with:
      groupBy:
      - gmlFilename
      calculations:
      - newAttribute: _num_lod2_invalid_surface
        expr: |
          if env.get("__value").lod == "2" { 1 } else { 0 }
      - newAttribute: _num_lod3_invalid_surface
        expr: |
          if env.get("__value").lod == "3" { 1 } else { 0 }
      - newAttribute: _num_lod4_invalid_surface
        expr: |
          if env.get("__value").lod == "4" { 1 } else { 0 }
  - id: f0020c57-c068-4c73-b1a1-98edfa9af817
    name: AttributeMapperLod2-4InvalidSurface
    type: action
    action: AttributeMapper
    with:
      mappers:
      - attribute: filename
        expr: |
          env.get("__value").gmlFilename
      - attribute: feature_type
        expr: |
          env.get("__value").featureType
      - attribute: gml_id
        expr: |
          env.get("__value").gmlId
      - attribute: lod
        expr: |
          env.get("__value").lod
      - attribute: issue
        expr: |
          let value = env.get("__value");
          if value.validationResult?.details != () {
            return value.validationResult.details[0][0];
          }
          if "issue" in value {
            return value.issue;
          }
          "UnknownError"
  - id: 43ad58ef-76db-4af3-bbb7-aa05df830bbd
    name: FeatureWriterLod2-4InvalidSurface
    type: action
    action: FeatureWriter
    with:
      format: csv
      output: |
        file::join_path(env.get("workerArtifactPath") ?? env.get("outputPath"), "02_建築物_LOD2以上境界面のエラー.csv")
  - id: 675fc95a-e4ca-4381-9b68-367a71c49a96
    name: ErrorCount-Lod2InvalidSurface
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLod2InvalidSurface
  - id: c8873b8c-6074-4792-8c27-9a1f134df143
    name: ErrorCount-Lod3InvalidSurface
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLod3InvalidSurface
  - id: 7bbd918a-d05e-402d-b868-05c58f2c7cd8
    name: ErrorCount-Lod4InvalidSurface
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLod4InvalidSurface
  - id: e3c5be96-3e87-40df-a9b2-a4854def980e
    name: GeometryCoercerLod0SurfaceIntersection
    type: action
    action: GeometryCoercer
    with:
      targetType: lineString
  - id: 20eab502-d2dc-4a03-a796-691659edb8d7
    name: TwoDimensionForcer
    type: action
    action: TwoDimensionForcer
  - id: a0691024-5055-4a0e-a1fc-1b9db1be955c
    name: AreaOnAreaOverlayerLod0
    type: action
    action: AreaOnAreaOverlayer
    with:
      accumulationMode: dropIncomingAttributes
      outputAttribute: overlap
      generateList: list
  - id: c8f95027-60ec-4040-b50d-0a60196d1bf9
    name: FeatureFilterByAreaOnAreaOverlap
    type: action
    action: FeatureFilter
    with:
      conditions:
      - expr: |
          env.get("__value").overlap > 1
        outputPort: intersectionSurface
  - id: 45266834-15c7-49bf-b95b-4a508ef5978a
    name: ListIndexer1
    type: action
    action: ListIndexer
    with:
      listAttribute: list
      listIndexToCopy: 0
      copiedAttributeSuffix: _1
  - id: 14a3b9a0-453c-445d-86c5-ee164a766e09
    name: ListIndexer2
    type: action
    action: ListIndexer
    with:
      listAttribute: list
      listIndexToCopy: 1
      copiedAttributeSuffix: _2
  - id: ad848249-1f75-4fc8-b514-277194f0a7a9
    name: AttributeMapperLod0SurfaceIntersection
    type: action
    action: AttributeMapper
    with:
      mappers:
      - attribute: filename_a
        expr: env.get("__value").gmlFilename_1
      - attribute: filename_b
        expr: env.get("__value").gmlFilename_2
      - attribute: feature_type_a
        expr: env.get("__value").featureType_1
      - attribute: feature_type_b
        expr: env.get("__value").featureType_2
      - attribute: lod_a
        expr: env.get("__value").lod_1
      - attribute: lod_b
        expr: env.get("__value").lod_2
      - attribute: gml_id_a
        expr: env.get("__value").gmlId_1
      - attribute: gml_id_b
        expr: env.get("__value").gmlId_2
      - attribute: issue
        expr: |
          "Surface Intersection"
  - id: 72d66764-a395-46f2-8cff-b13d975dafc2
    name: FeatureWriterLod0SurfaceIntersection
    type: action
    action: FeatureWriter
    with:
      format: csv
      output: |
        file::join_path(env.get("workerArtifactPath") ?? env.get("outputPath"), "02_建築物_LOD0面の交差.csv")
  - id: 6a31194d-f1c7-474e-858d-6c3afcfe1a27
    name: Lod0SurfaceIntersectionCounter
    type: action
    action: StatisticsCalculator
    with:
      groupId: gmlFilename
      groupBy:
      - filename_a
      calculations:
      - newAttribute: _num_lod0_surface_intersection
        expr: '1'
  - id: 34b68258-fc4c-48a9-8b2f-87273dbb1119
    name: ErrorCount-Lod0SurfaceIntersection
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLod0SurfaceIntersection
  - id: 69362518-8f36-46bf-b6dd-f2f6c5e3dfdc
    name: DestinationMeshCodeExtractor
    type: action
    action: PLATEAU4.DestinationMeshCodeExtractor
    with:
      meshType: 3
      epsgCode: env.get("prcs") ?? "10168"
      meshcodeAttr: meshcode
  - id: 514c47e7-c503-4b1b-aed4-363ea9de3089
    name: MeshCodeTester
    type: action
    action: FeatureFilter
    with:
      conditions:
      - expr: |
          !env.get("__value").gmlFilename.starts_with(env.get("__value").meshcode)
        outputPort: failed
  - id: db255937-2dcf-48ae-8c9a-80c6a1567525
    name: AttributeMapperIncorrectMeshCode
    type: action
    action: AttributeMapper
    with:
      mappers:
      - attribute: gmlFilename
        expr: |
          env.get("__value").gmlFilename
      - attribute: filename
        expr: |
          env.get("__value").gmlFilename
      - attribute: feature_type
        expr: |
          env.get("__value").featureType
      - attribute: lod
        expr: |
          env.get("__value").lod
      - attribute: gml_id
        expr: |
          env.get("__value").gmlId
      - attribute: meshcode
        expr: |
          env.get("__value").meshcode
      - attribute: meshcount
        expr: |
          env.get("__value")._mesh_count
      - attribute: mesh2area
        expr: |
          env.get("__value")._meshcode_to_area
  - id: da9a19fe-67f4-4996-955a-78aa385004d8
    name: AttributeManagerIncorrectMeshCode
    type: action
    action: AttributeManager
    with:
      operations:
      - attribute: gmlFilename
        method: remove
  - id: fb8987c8-0eb0-45e1-b44f-f55f99edb30c
    name: FeatureWriterIncorrectMeshCode
    type: action
    action: FeatureWriter
    with:
      format: csv
      output: |
        file::join_path(env.get("workerArtifactPath") ?? env.get("outputPath"), "02_建築物_図郭不正.csv")
  - id: 3a31c3d8-2a40-465c-a5c4-f9362e08a2a5
    name: IncorrectMeshCodeCounter
    type: action
    action: StatisticsCalculator
    with:
      groupBy:
      - gmlFilename
      calculations:
      - newAttribute: _num_incorrect_meshcode
        expr: '1'
  - id: 0d5eb4ef-3a3f-44d7-b405-2e6de9c047d6
    name: ErrorCount-IncorrectMeshCode
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountIncorrectMeshcode
  - id: ca5721b4-fcdb-4f2b-8f2a-5a46e675aefb
    name: OutputRouter
    type: action
    action: OutputRouter
    with:
      routingPort: fileOutput
  - id: c3daf364-bb5f-4ba4-8a74-b8a84b66e326
    name: SolidBoundaryValidator
    type: action
    action: SolidBoundaryValidator
  - id: 82d81181-75e7-459a-bd2b-c096384ffe07
    name: FeatureFilterInvalidSolidBoundary
    type: action
    action: FeatureFilter
    with:
      conditions:
      - expr: |
          let issue = env.get("__value").solid_boundary_issues.issue;
          issue == "NotA2Manifold"
        outputPort: notClosed
  - id: fed2be14-83a7-4be0-b768-da04ead271b1
    name: AttributeMapperSolidBoundaryInvalidNotClosed
    type: action
    action: AttributeMapper
    with:
      mappers:
      - attribute: filename
        expr: |
          env.get("__value").gmlFilename
      - attribute: feature_type
        expr: |
          env.get("__value").featureType
      - attribute: gml_id
        expr: |
          env.get("__value").gmlId
      - attribute: lod
        expr: |
          env.get("__value").lod
      - attribute: issue
        expr: |
          "Surface Not Closed"
  - id: bc4710ca-23fd-4dc7-898c-914e145d64da
    name: FeatureWriterL14-BoundaryNotClosed
    type: action
    action: FeatureWriter
    with:
      format: csv
      output: |
        file::join_path(env.get("workerArtifactPath") ?? env.get("outputPath"), "02_建築物_非水密体.csv")
  - id: 3224fe40-b38c-4aa3-9733-381d21056ab0
    name: Lod1-4NotClosedSolidCounter
    type: action
    action: StatisticsCalculator
    with:
      groupBy:
      - gmlFilename
      calculations:
      - newAttribute: _num_lod1_not_closed_solid
        expr: |
          if env.get("__value").lod == "1" { 1 } else { 0 }
      - newAttribute: _num_lod2_not_closed_solid
        expr: |
          if env.get("__value").lod == "2" { 1 } else { 0 }
      - newAttribute: _num_lod3_not_closed_solid
        expr: |
          if env.get("__value").lod == "3" { 1 } else { 0 }
      - newAttribute: _num_lod4_not_closed_solid
        expr: |
          if env.get("__value").lod == "4" { 1 } else { 0 }
  - id: d6e679e6-6f1e-4423-9cb0-1c021c815921
    name: ErrorCount-Lod1NotClosedSolid
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLod1NotClosedSolid
  - id: d2b324a1-b32d-44ec-b18e-631a14819d89
    name: AttributeMapperSolidBoundaryInvalidOtherIssues
    type: action
    action: AttributeMapper
    with:
      mappers:
      - attribute: filename
        expr: |
          env.get("__value").gmlFilename
      - attribute: feature_type
        expr: |
          env.get("__value").featureType
      - attribute: gml_id
        expr: |
          env.get("__value").gmlId
      - attribute: lod
        expr: |
          env.get("__value").lod
      - attribute: issue
        expr: |
          "InvalidSolidBoundaries"
  - id: f11a2bbe-e643-4fbd-91a4-631a60d2cde3
    name: FeatureWriterL14-BoundaryOtherIssues
    type: action
    action: FeatureWriter
    with:
      format: csv
      output: |
        file::join_path(env.get("workerArtifactPath") ?? env.get("outputPath"), "02_建築物_立体のエラー.csv")
  - id: c30a7338-90bd-4287-a46e-0c5dd7bb184c
    name: Lod1-4SolidIssuesCounter
    type: action
    action: StatisticsCalculator
    with:
      groupBy:
      - gmlFilename
      calculations:
      - newAttribute: _num_lod1_solid_issues
        expr: |
          if env.get("__value").lod == "1" { 1 } else { 0 }
      - newAttribute: _num_lod2_solid_issues
        expr: |
          if env.get("__value").lod == "2" { 1 } else { 0 }
      - newAttribute: _num_lod3_solid_issues
        expr: |
          if env.get("__value").lod == "3" { 1 } else { 0 }
      - newAttribute: _num_lod4_solid_issues
        expr: |
          if env.get("__value").lod == "4" { 1 } else { 0 }
  - id: 61b01f44-5524-4b79-b745-1aabef1fb333
    name: ErrorCount-Lod1SolidIssues
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLod1SolidIssues
  - id: 6ab9693b-916e-4bb9-84db-5edf7ce9b19f
    name: ErrorCount-Lod2NotClosedSolid
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLod2NotClosedSolid
  - id: 4c7aa7ea-ceab-4013-8222-3529bd1969c0
    name: ErrorCount-Lod3NotClosedSolid
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLod3NotClosedSolid
  - id: fb371d4a-121a-4d58-b528-8ecd322a7eac
    name: ErrorCount-Lod4NotClosedSolid
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLod4NotClosedSolid
  - id: 8d713e5a-5554-4c02-a726-dda22cd1356d
    name: ErrorCount-Lod2SolidIssues
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLod2SolidIssues
  - id: 52801a23-9945-4852-bbe2-99e2afcd6497
    name: ErrorCount-Lod3SolidIssues
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLod3SolidIssues
  - id: 7e45c3ce-3b7d-42fb-a51b-aa7a5ea258e8
    name: ErrorCount-Lod4SolidIssues
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLod4SolidIssues
  - id: 5dc56e4a-2373-437a-89d2-97dbe3788590
    name: SolidBoundaryNotClosedIssueCounter
    type: action
    action: StatisticsCalculator
    with:
      groupId: gmlFilename
      groupBy:
      - filename
      calculations:
      - newAttribute: _num_lod1_not_closed_solid
        expr: '1'
  - id: 5ddfbecd-22b6-4523-8bf9-9e96c0613209
    name: SolidBoundaryNotClosedIssueCountOutputRouter
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLod1NotClosedSolid
  - id: 2e8de9fa-58f6-44fa-9562-57915c97fad1
    name: SolidBoundaryOtherIssueCounter
    type: action
    action: StatisticsCalculator
    with:
      groupId: gmlFilename
      groupBy:
      - filename
      calculations:
      - newAttribute: _num_lod1_solid_issues
        expr: '1'
  - id: 5324eff5-c5f8-43e9-9ab1-8af2862b8359
    name: SolidBoundaryOtherIssueCountOutputRouter
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLod1SolidIssues
  - id: 4519a712-841c-4656-af30-3c3925e0bf27
    name: GeometryExtractorSolidIntersection
    type: action
    action: GeometryExtractor
    with:
      outputAttribute: _solid_geometry
  - id: e73c9e92-b1aa-4234-8979-80e536748c2f
    name: FootprintReplacerSolidIntersection
    type: action
    action: FootprintReplacer
  - id: d21b5e83-7506-48ad-a5fc-c5f606832f6f
    name: AreaOnAreaOverlayerSolidIntersection
    type: action
    action: AreaOnAreaOverlayer
    with:
      accumulationMode: dropIncomingAttributes
      outputAttribute: overlap
      generateList: list
  - id: 4f3ed50e-667d-486c-b071-a5ceba131f5f
    name: FeatureFilterSolidIntersectionOverlap
    type: action
    action: FeatureFilter
    with:
      conditions:
      - expr: |
          env.get("__value").overlap > 1
        outputPort: overlapping
  - id: df9c975b-8383-447e-929c-a170d3ee2f81
    name: PLATEAU4.SolidIntersectionTestPairCreator
    type: action
    action: PLATEAU4.SolidIntersectionTestPairCreator
    with:
      listAttribute: list
      gmlIdAttribute: gmlId
      pairIdAttribute: pair_id
  - id: 61c7060d-dfd7-49f5-9a99-0a8eb3debd6d
    name: GeometryReplacerSolidIntersectionA
    type: action
    action: GeometryReplacer
    with:
      sourceAttribute: _solid_geometry
  - id: 14920161-f4f3-4503-a139-27f394d9a98c
    name: GeometryReplacerSolidIntersectionB
    type: action
    action: GeometryReplacer
    with:
      sourceAttribute: _solid_geometry
  - id: b4ac40b2-24d5-47a4-81df-21d973e298f4
    name: CSGBuilder
    type: action
    action: CSGBuilder
    with:
      pairIdAttribute: env.get("__value").pair_id
      createList: true
      listAttributeName: attrList
  - id: ebc5cffe-d383-4b4f-970e-2e8c06f60803
    name: CSGEvaluator
    type: action
    action: CSGEvaluator
    with:
      operation: intersection
  - id: 9999546f-4f65-4683-8b0d-124efc9460c1
    name: AttributeMapperSolidIntersection
    type: action
    action: AttributeMapper
    with:
      mappers:
      - attribute: intersection_id
        expr: |
          "lod" + env.get("__value").attrList[0].lod + "_" + env.get("__value").attrList[0].pair_id
      - attribute: gmlFilenameA
        expr: |
          env.get("__value").attrList[0].gmlFilename
      - attribute: gmlFilenameB
        expr: |
          env.get("__value").attrList[1].gmlFilename
      - attribute: featureTypeA
        expr: |
          env.get("__value").attrList[0].featureType
      - attribute: featureTypeB
        expr: |
          env.get("__value").attrList[1].featureType
      - attribute: lodA
        expr: |
          env.get("__value").attrList[0].lod
      - attribute: lodB
        expr: |
          env.get("__value").attrList[1].lod
      - attribute: gmlIdA
        expr: |
          env.get("__value").attrList[0].gmlId
      - attribute: gmlIdB
        expr: |
          env.get("__value").attrList[1].gmlId
      - attribute: issue
        expr: |
          "Solid Intersection"
  - id: a99841e6-269b-40ca-9da6-e2e8fac9b8da
    name: FeatureWriterLod1SolidIntersection
    type: action
    action: FeatureWriter
    with:
      format: csv
      output: |
        file::join_path(env.get("workerArtifactPath") ?? env.get("outputPath"), "02_建築物_立体交差.csv")
  - id: c129245e-9c15-4d12-9818-b589544ce20e
    name: SolidIntersectionCounter
    type: action
    action: StatisticsCalculator
    with:
      groupId: gmlFilename
      groupBy:
      - gmlFilenameA
      calculations:
      - newAttribute: _num_lod1_solid_intersection
        expr: |
          if env.get("__value").lodA == "1" { 1 } else { 0 }
      - newAttribute: _num_lod2_solid_intersection
        expr: |
          if env.get("__value").lodA == "2" { 1 } else { 0 }
      - newAttribute: _num_lod3_solid_intersection
        expr: |
          if env.get("__value").lodA == "3" { 1 } else { 0 }
      - newAttribute: _num_lod4_solid_intersection
        expr: |
          if env.get("__value").lodA == "4" { 1 } else { 0 }
  - id: 48caed0f-8784-40dc-ae8f-f6b55060305d
    name: ErrorCount-Lod1SolidIntersection
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLod1SolidIntersection
  - id: fe51cc50-087e-4287-b3a5-90aca26bb3a2
    name: ErrorCount-Lod2SolidIntersection
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLod2SolidIntersection
  - id: 2aba5bc7-3bf1-4626-a4a5-ec1bcbf8091a
    name: ErrorCount-Lod3SolidIntersection
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLod3SolidIntersection
  - id: cd3d3545-3264-411d-92c1-12a39dde7c8b
    name: ErrorCount-Lod4SolidIntersection
    type: action
    action: OutputRouter
    with:
      routingPort: errorCountLod4SolidIntersection
  edges:
  - id: 6a624b4c-4960-4e09-b1dd-874721823f74
    from: 88995ed0-27b5-4e25-a955-978267c78814
    to: c19d754d-bf4b-4d01-8c90-d1de1ee14c59
    fromPort: inCorrectOrientation
    toPort: default
  - id: 9cc71c9f-cbc3-4d03-8524-c17763bca697
    from: c19d754d-bf4b-4d01-8c90-d1de1ee14c59
    to: ca5721b4-fcdb-4f2b-8f2a-5a46e675aefb
    fromPort: default
    toPort: default
  - id: db3d5321-fda0-4af6-9c8e-eac19877a258
    from: 88995ed0-27b5-4e25-a955-978267c78814
    to: 87efa888-d6e2-4261-a1ce-04fef784caf2
    fromPort: invalidSurface
    toPort: default
  - id: 24391627-0148-4cac-9c8c-dc1e0af444eb
    from: 87efa888-d6e2-4261-a1ce-04fef784caf2
    to: efc3cc9a-1def-4883-a45a-d75b40713e96
    fromPort: complete
    toPort: default
  - id: b335a34f-e4d8-4ed0-ab6c-f9efebc71ab1
    from: efc3cc9a-1def-4883-a45a-d75b40713e96
    to: 58a8524b-aabc-4f97-bd88-3a0d29bedfb5
    fromPort: default
    toPort: default
  - id: c21969dd-740b-4349-8149-3692153c6c40
    from: 87efa888-d6e2-4261-a1ce-04fef784caf2
    to: 66ca88b4-13cb-4635-af48-12cf1e8c0a4c
    fromPort: default
    toPort: default
  - id: 54392d30-36dd-420a-8b56-98cc7c56b50f
    from: 58a8524b-aabc-4f97-bd88-3a0d29bedfb5
    to: ca5721b4-fcdb-4f2b-8f2a-5a46e675aefb
    fromPort: default
    toPort: default
  - id: 216a4dbc-a1fc-42a0-a97b-f637623e1585
    from: 7891eb04-45d5-4188-8acb-3bb277a126b6
    to: 54fdff9d-406a-4a88-8d83-1fb7503e2b51
    fromPort: lod1
    toPort: default
  - id: e4b6f467-fc6d-40cc-b0e0-8ad059cf7241
    from: 54fdff9d-406a-4a88-8d83-1fb7503e2b51
    to: 0997425f-664a-4e34-9b82-f3bcb74ef5c7
    fromPort: invalidSurface
    toPort: default
  - id: c85eaf91-2b1f-440c-b207-8adc890d6ee2
    from: 0997425f-664a-4e34-9b82-f3bcb74ef5c7
    to: 5eb5c234-a00e-4dc3-b7c5-7de14e75d428
    fromPort: complete
    toPort: default
  - id: 8ff40cab-c523-4d7a-8547-bbd853a2baf0
    from: 0997425f-664a-4e34-9b82-f3bcb74ef5c7
    to: 71cc70f0-0812-4ccd-9659-139202d945d9
    fromPort: default
    toPort: default
  - id: ac9fe55c-0a31-4df4-ab22-0210f6ac3b3f
    from: 5eb5c234-a00e-4dc3-b7c5-7de14e75d428
    to: 6b8ca91f-12ea-4507-9f3f-d6b5bdc8ac56
    fromPort: default
    toPort: default
  - id: 62c86fe0-e44e-4186-b0e2-8b9a61b50b3a
    from: 6b8ca91f-12ea-4507-9f3f-d6b5bdc8ac56
    to: ca5721b4-fcdb-4f2b-8f2a-5a46e675aefb
    fromPort: default
    toPort: default
  - id: 9f085147-35b3-45a0-8c1a-7e84593e9b1b
    from: 7891eb04-45d5-4188-8acb-3bb277a126b6
    to: d71c31ad-1ecd-4829-b368-7e0c0c6bd431
    fromPort: lod2
    toPort: default
  - id: 40ec4743-fa81-4152-8edc-ffd39b2acea4
    from: 7891eb04-45d5-4188-8acb-3bb277a126b6
    to: d71c31ad-1ecd-4829-b368-7e0c0c6bd431
    fromPort: lod3
    toPort: default
  - id: f2f1a823-4fef-4747-be8f-05967eb608c2
    from: 7891eb04-45d5-4188-8acb-3bb277a126b6
    to: d71c31ad-1ecd-4829-b368-7e0c0c6bd431
    fromPort: lod4
    toPort: default
  - id: 002e4891-f9ab-47b3-9090-d2f99ca717cb
    from: d71c31ad-1ecd-4829-b368-7e0c0c6bd431
    to: 644bf900-3de8-4431-a325-1ae51fa2499f
    fromPort: surface
    toPort: default
  - id: 1e96613c-280f-4103-8e8c-1552c721c97f
    from: 644bf900-3de8-4431-a325-1ae51fa2499f
    to: 4804c5a8-3a6e-4e5d-ad3c-52149c8b5aa9
    fromPort: invalidSurface
    toPort: default
  - id: 638b9c0c-9a11-432f-8327-20815478f82c
    from: 4804c5a8-3a6e-4e5d-ad3c-52149c8b5aa9
    to: f0020c57-c068-4c73-b1a1-98edfa9af817
    fromPort: complete
    toPort: default
  - id: b9da1e9f-7cc7-4862-88f1-1085a872410c
    from: f0020c57-c068-4c73-b1a1-98edfa9af817
    to: 43ad58ef-76db-4af3-bbb7-aa05df830bbd
    fromPort: default
    toPort: default
  - id: c15b484c-1d13-46cc-9892-26b9b75359e2
    from: 43ad58ef-76db-4af3-bbb7-aa05df830bbd
    to: ca5721b4-fcdb-4f2b-8f2a-5a46e675aefb
    fromPort: default
    toPort: default
  - id: fd7567c0-42a6-4c28-b43c-aefa8559dd36
    from: 4804c5a8-3a6e-4e5d-ad3c-52149c8b5aa9
    to: 675fc95a-e4ca-4381-9b68-367a71c49a96
    fromPort: default
    toPort: default
  - id: f263cd28-418d-4ebb-a6f4-213afb708b15
    from: 4804c5a8-3a6e-4e5d-ad3c-52149c8b5aa9
    to: c8873b8c-6074-4792-8c27-9a1f134df143
    fromPort: default
    toPort: default
  - id: 49a94b2a-1e60-40c3-ae93-a3dca96033f0
    from: 4804c5a8-3a6e-4e5d-ad3c-52149c8b5aa9
    to: 7bbd918a-d05e-402d-b868-05c58f2c7cd8
    fromPort: default
    toPort: default
  - id: 02247fc3-f440-4f4d-8def-e5807cab2282
    from: 88995ed0-27b5-4e25-a955-978267c78814
    to: e3c5be96-3e87-40df-a9b2-a4854def980e
    fromPort: default
    toPort: default
  - id: b802664f-9237-4dcb-b009-88501a91ae37
    from: e3c5be96-3e87-40df-a9b2-a4854def980e
    to: 20eab502-d2dc-4a03-a796-691659edb8d7
    fromPort: default
    toPort: default
  - id: c2e8a941-b7d2-4ce5-b301-0d954c4964a3
    from: 20eab502-d2dc-4a03-a796-691659edb8d7
    to: a0691024-5055-4a0e-a1fc-1b9db1be955c
    fromPort: default
    toPort: default
  - id: f84478b3-ca33-4016-879e-887c2561d4e2
    from: a0691024-5055-4a0e-a1fc-1b9db1be955c
    to: c8f95027-60ec-4040-b50d-0a60196d1bf9
    fromPort: area
    toPort: default
  - id: 609c23ea-9f37-48aa-af23-4fed876e1e88
    from: c8f95027-60ec-4040-b50d-0a60196d1bf9
    to: 45266834-15c7-49bf-b95b-4a508ef5978a
    fromPort: intersectionSurface
    toPort: default
  - id: ee27e146-fd3a-4ee3-a7fb-5680f09e827d
    from: 45266834-15c7-49bf-b95b-4a508ef5978a
    to: 14a3b9a0-453c-445d-86c5-ee164a766e09
    fromPort: default
    toPort: default
  - id: 49abf00e-35a5-44be-8d6a-714392b1e312
    from: 14a3b9a0-453c-445d-86c5-ee164a766e09
    to: ad848249-1f75-4fc8-b514-277194f0a7a9
    fromPort: default
    toPort: default
  - id: 529cc4e8-b943-4e43-946a-6cab7dd9aa99
    from: ad848249-1f75-4fc8-b514-277194f0a7a9
    to: 6a31194d-f1c7-474e-858d-6c3afcfe1a27
    fromPort: default
    toPort: default
  - id: 2b01f157-d45f-451c-a364-b27a070fcd4f
    from: 6a31194d-f1c7-474e-858d-6c3afcfe1a27
    to: 72d66764-a395-46f2-8cff-b13d975dafc2
    fromPort: complete
    toPort: default
  - id: 8530f45d-3c14-44d9-977a-59071b52b5ee
    from: 6a31194d-f1c7-474e-858d-6c3afcfe1a27
    to: 34b68258-fc4c-48a9-8b2f-87273dbb1119
    fromPort: default
    toPort: default
  - id: b091de70-c8bf-4f5f-8943-89fb6a91260b
    from: 20eab502-d2dc-4a03-a796-691659edb8d7
    to: 69362518-8f36-46bf-b6dd-f2f6c5e3dfdc
    fromPort: default
    toPort: default
  - id: bb3d4932-2981-444c-ab70-d2c24ba126df
    from: 69362518-8f36-46bf-b6dd-f2f6c5e3dfdc
    to: 514c47e7-c503-4b1b-aed4-363ea9de3089
    fromPort: default
    toPort: default
  - id: 6ef57bfc-3345-4c62-8cfa-dfd0181e560f
    from: 514c47e7-c503-4b1b-aed4-363ea9de3089
    to: ca5721b4-fcdb-4f2b-8f2a-5a46e675aefb
    fromPort: default
    toPort: default
  - id: a3fa0452-4c32-434d-baba-4ac2a8dae2d3
    from: 72d66764-a395-46f2-8cff-b13d975dafc2
    to: ca5721b4-fcdb-4f2b-8f2a-5a46e675aefb
    fromPort: default
    toPort: default
  - id: aaf6ad59-a19f-469e-bd83-08d5a36a0a67
    from: 7891eb04-45d5-4188-8acb-3bb277a126b6
    fromPort: lod1
    to: c3daf364-bb5f-4ba4-8a74-b8a84b66e326
    toPort: default
  - id: 66d3b314-2e07-44c9-b8ad-6a1a76d6e6d7
    from: 7891eb04-45d5-4188-8acb-3bb277a126b6
    fromPort: lod2
    to: d71c31ad-1ecd-4829-b368-7e0c0c6bd431
    toPort: default
  - id: adb14c34-bbc8-417d-8122-10e95392604c
    from: 7891eb04-45d5-4188-8acb-3bb277a126b6
    fromPort: lod3
    to: d71c31ad-1ecd-4829-b368-7e0c0c6bd431
    toPort: default
  - id: db8c37c3-cd64-47c9-8a14-bf2344505985
    from: 7891eb04-45d5-4188-8acb-3bb277a126b6
    fromPort: lod4
    to: d71c31ad-1ecd-4829-b368-7e0c0c6bd431
    toPort: default
  - id: 89c37da5-ff6f-4b4e-b1f5-3a8a58a80dfa
    from: c3daf364-bb5f-4ba4-8a74-b8a84b66e326
    to: 82d81181-75e7-459a-bd2b-c096384ffe07
    fromPort: failed
    toPort: default
  - id: b5b62993-746e-45a2-9e8b-aa856a3ac52e
    from: 82d81181-75e7-459a-bd2b-c096384ffe07
    to: fed2be14-83a7-4be0-b768-da04ead271b1
    fromPort: notClosed
    toPort: default
  - id: 131b36b1-77c7-4013-b434-f66b63986758
    from: fed2be14-83a7-4be0-b768-da04ead271b1
    to: bc4710ca-23fd-4dc7-898c-914e145d64da
    fromPort: default
    toPort: default
  - id: 59d28ceb-3d9d-4e4a-9a06-ac52c521324e
    from: 82d81181-75e7-459a-bd2b-c096384ffe07
    to: d2b324a1-b32d-44ec-b18e-631a14819d89
    fromPort: unfiltered
    toPort: default
  - id: 4fb530ca-22f6-4f93-a690-0178200b8ac0
    from: d2b324a1-b32d-44ec-b18e-631a14819d89
    to: f11a2bbe-e643-4fbd-91a4-631a60d2cde3
    fromPort: default
    toPort: default
  - id: 12702427-59b4-4a17-a347-d34c2f667f4f
    from: fed2be14-83a7-4be0-b768-da04ead271b1
    to: 5dc56e4a-2373-437a-89d2-97dbe3788590
    fromPort: default
    toPort: default
  - id: 44ad7993-29df-4a4e-bc7b-fef613ae7727
    from: 5dc56e4a-2373-437a-89d2-97dbe3788590
    to: 5ddfbecd-22b6-4523-8bf9-9e96c0613209
    fromPort: default
    toPort: default
  - id: d4d6fb5d-37d3-4203-baae-099bd53a781d
    from: d2b324a1-b32d-44ec-b18e-631a14819d89
    to: 2e8de9fa-58f6-44fa-9562-57915c97fad1
    fromPort: default
    toPort: default
  - id: a9d3856b-18fc-42b2-9eef-91d7e4f0a1ea
    from: 2e8de9fa-58f6-44fa-9562-57915c97fad1
    to: 5324eff5-c5f8-43e9-9ab1-8af2862b8359
    fromPort: default
    toPort: default
  - id: 5929876a-df7d-44e2-9efb-5473c252261f
    from: 3224fe40-b38c-4aa3-9733-381d21056ab0
    to: d6e679e6-6f1e-4423-9cb0-1c021c815921
    fromPort: default
    toPort: default
  - id: 8e237401-934c-45d0-a9f4-743bfb4faeea
    from: 3224fe40-b38c-4aa3-9733-381d21056ab0
    to: 6ab9693b-916e-4bb9-84db-5edf7ce9b19f
    fromPort: default
    toPort: default
  - id: d1806d48-edb4-4b62-90ec-a3ac999476d0
    from: 3224fe40-b38c-4aa3-9733-381d21056ab0
    to: 4c7aa7ea-ceab-4013-8222-3529bd1969c0
    fromPort: default
    toPort: default
  - id: 872621f4-05a5-489e-a563-536d5d1ebdb6
    from: 3224fe40-b38c-4aa3-9733-381d21056ab0
    to: fb371d4a-121a-4d58-b528-8ecd322a7eac
    fromPort: default
    toPort: default
  - id: a78eb98d-e71c-4977-b1ff-cd93240628df
    from: c30a7338-90bd-4287-a46e-0c5dd7bb184c
    to: 61b01f44-5524-4b79-b745-1aabef1fb333
    fromPort: default
    toPort: default
  - id: b2499b78-2901-452e-a784-8a82c49091d7
    from: c30a7338-90bd-4287-a46e-0c5dd7bb184c
    to: 8d713e5a-5554-4c02-a726-dda22cd1356d
    fromPort: default
    toPort: default
  - id: 10c8237d-c865-4615-9a4f-33958c6fa529
    from: c30a7338-90bd-4287-a46e-0c5dd7bb184c
    to: 52801a23-9945-4852-bbe2-99e2afcd6497
    fromPort: default
    toPort: default
  - id: 55989c1c-367c-4ca0-9c10-d5da869a435b
    from: c30a7338-90bd-4287-a46e-0c5dd7bb184c
    to: 7e45c3ce-3b7d-42fb-a51b-aa7a5ea258e8
    fromPort: default
    toPort: default
  - id: 93c7359f-02b4-4645-99e0-0f378c3b2b89
    from: 514c47e7-c503-4b1b-aed4-363ea9de3089
    to: db255937-2dcf-48ae-8c9a-80c6a1567525
    fromPort: failed
    toPort: default
  - id: 3b67c8b9-f9d6-4516-b082-c4c66236a8f1
    from: db255937-2dcf-48ae-8c9a-80c6a1567525
    to: da9a19fe-67f4-4996-955a-78aa385004d8
    fromPort: default
    toPort: default
  - id: c53815dc-56ce-459b-9ec2-fe7455e883d3
    from: da9a19fe-67f4-4996-955a-78aa385004d8
    to: fb8987c8-0eb0-45e1-b44f-f55f99edb30c
    fromPort: default
    toPort: default
  - id: b1a9c0a5-25e3-446e-86ef-a8930841c299
    from: db255937-2dcf-48ae-8c9a-80c6a1567525
    to: 3a31c3d8-2a40-465c-a5c4-f9362e08a2a5
    fromPort: default
    toPort: default
  - id: cb51b458-bf8a-4662-ba11-552760d1f5db
    from: 3a31c3d8-2a40-465c-a5c4-f9362e08a2a5
    to: 0d5eb4ef-3a3f-44d7-b405-2e6de9c047d6
    fromPort: default
    toPort: default
  - id: d7610471-6a31-4bdc-825a-610910781fae
    from: fb8987c8-0eb0-45e1-b44f-f55f99edb30c
    to: ca5721b4-fcdb-4f2b-8f2a-5a46e675aefb
    fromPort: default
    toPort: default
  - id: 03d1fe2d-f97e-4277-971f-23ca7ecfbb98
    from: bc4710ca-23fd-4dc7-898c-914e145d64da
    to: ca5721b4-fcdb-4f2b-8f2a-5a46e675aefb
    fromPort: default
    toPort: default
  - id: 5813c2b5-0d36-47b6-901c-b6d45a181cbd
    from: f11a2bbe-e643-4fbd-91a4-631a60d2cde3
    to: ca5721b4-fcdb-4f2b-8f2a-5a46e675aefb
    fromPort: default
    toPort: default
  - id: 2efa8ebe-9ab4-47c9-bb7a-2cb29f09c1ae
    from: 7891eb04-45d5-4188-8acb-3bb277a126b6
    to: 4519a712-841c-4656-af30-3c3925e0bf27
    fromPort: lod1
    toPort: default
  - id: c08132ee-0728-4df5-9e25-1d02d0ae7f2f
    from: 7891eb04-45d5-4188-8acb-3bb277a126b6
    to: 4519a712-841c-4656-af30-3c3925e0bf27
    fromPort: lod2
    toPort: default
  - id: 110126cb-3f1b-4dfd-bdb1-fb43f37d358d
    from: 7891eb04-45d5-4188-8acb-3bb277a126b6
    to: 4519a712-841c-4656-af30-3c3925e0bf27
    fromPort: lod3
    toPort: default
  - id: 2daa0043-e79a-4ee2-a600-8eb3516a7e0b
    from: 7891eb04-45d5-4188-8acb-3bb277a126b6
    to: 4519a712-841c-4656-af30-3c3925e0bf27
    fromPort: lod4
    toPort: default
  - id: 2e596a28-bf96-45d8-a969-34b2ab593f38
    from: 4519a712-841c-4656-af30-3c3925e0bf27
    to: e73c9e92-b1aa-4234-8979-80e536748c2f
    fromPort: default
    toPort: default
  - id: f60f994c-43c4-4702-b8d8-38accb1f3964
    from: e73c9e92-b1aa-4234-8979-80e536748c2f
    to: d21b5e83-7506-48ad-a5fc-c5f606832f6f
    fromPort: footprint
    toPort: default
  - id: d0f06baa-c32c-4748-a0a9-8ba76a550cc9
    from: d21b5e83-7506-48ad-a5fc-c5f606832f6f
    to: 4f3ed50e-667d-486c-b071-a5ceba131f5f
    fromPort: area
    toPort: default
  - id: c6486ccc-83bc-41b7-8275-588dd0ce835f
    from: 4f3ed50e-667d-486c-b071-a5ceba131f5f
    to: df9c975b-8383-447e-929c-a170d3ee2f81
    fromPort: overlapping
    toPort: default
  - id: 1bf39fd8-4601-4fa8-9805-94f9cf9b0b56
    from: df9c975b-8383-447e-929c-a170d3ee2f81
    to: 61c7060d-dfd7-49f5-9a99-0a8eb3debd6d
    fromPort: A
    toPort: default
  - id: 55124d4c-aa9f-4d60-adfc-020638bd1491
    from: df9c975b-8383-447e-929c-a170d3ee2f81
    to: 14920161-f4f3-4503-a139-27f394d9a98c
    fromPort: B
    toPort: default
  - id: 504e0f39-ec9c-45c9-a850-eeb132c20391
    from: 61c7060d-dfd7-49f5-9a99-0a8eb3debd6d
    to: b4ac40b2-24d5-47a4-81df-21d973e298f4
    fromPort: default
    toPort: left
  - id: dc23db9b-47d4-4deb-9e66-b5de7fdab997
    from: 14920161-f4f3-4503-a139-27f394d9a98c
    to: b4ac40b2-24d5-47a4-81df-21d973e298f4
    fromPort: default
    toPort: right
  - id: fddfce80-dd64-48b5-a47a-73702650d856
    from: b4ac40b2-24d5-47a4-81df-21d973e298f4
    to: ebc5cffe-d383-4b4f-970e-2e8c06f60803
    fromPort: intersection
    toPort: default
  - id: 4a8008bd-38b0-415b-b01c-c064b26b7f51
    from: ebc5cffe-d383-4b4f-970e-2e8c06f60803
    to: 9999546f-4f65-4683-8b0d-124efc9460c1
    fromPort: default
    toPort: default
  - id: 68ad80df-f685-4cd2-bb54-64375d44acb8
    from: 9999546f-4f65-4683-8b0d-124efc9460c1
    to: a99841e6-269b-40ca-9da6-e2e8fac9b8da
    fromPort: default
    toPort: default
  - id: 1f889123-7dc4-43c6-a2e2-3de78561438c
    from: a99841e6-269b-40ca-9da6-e2e8fac9b8da
    to: ca5721b4-fcdb-4f2b-8f2a-5a46e675aefb
    fromPort: default
    toPort: default
  - id: 1f82422f-1c1e-4a6a-94d7-87f44ae0d4f2
    from: 9999546f-4f65-4683-8b0d-124efc9460c1
    to: c129245e-9c15-4d12-9818-b589544ce20e
    fromPort: default
    toPort: default
  - id: d4b194d6-bce5-4404-8dac-0dc9add5665f
    from: c129245e-9c15-4d12-9818-b589544ce20e
    to: 48caed0f-8784-40dc-ae8f-f6b55060305d
    fromPort: default
    toPort: default
  - id: 2db11837-14de-435a-afeb-f11c046e2170
    from: c129245e-9c15-4d12-9818-b589544ce20e
    to: fe51cc50-087e-4287-b3a5-90aca26bb3a2
    fromPort: default
    toPort: default
  - id: 5479f3ce-8096-47ca-9cce-e5014336a8b2
    from: c129245e-9c15-4d12-9818-b589544ce20e
    to: 2aba5bc7-3bf1-4626-a4a5-ec1bcbf8091a
    fromPort: default
    toPort: default
  - id: 3457b43f-766e-434a-b560-ee04fc2d5694
    from: c129245e-9c15-4d12-9818-b589544ce20e
    to: cd3d3545-3264-411d-92c1-12a39dde7c8b
    fromPort: default
    toPort: default
  ports:
    outputs:
    - id: errorCountLod0IncorrectOrientation
      nodeId: 80fec261-afa7-446c-a6a2-27c6f61a666f
      port: default
    - id: errorCountLod0InvalidSurface
      nodeId: 66ca88b4-13cb-4635-af48-12cf1e8c0a4c
      port: default
    - id: errorCountLod0SurfaceIntersection
      nodeId: 34b68258-fc4c-48a9-8b2f-87273dbb1119
      port: default
    - id: errorCountLod1InvalidSurface
      nodeId: 71cc70f0-0812-4ccd-9659-139202d945d9
      port: default
    - id: errorCountLod1NotClosedSolid
      nodeId: 5ddfbecd-22b6-4523-8bf9-9e96c0613209
      port: default
    - id: errorCountLod1SolidIssues
      nodeId: 5324eff5-c5f8-43e9-9ab1-8af2862b8359
      port: default
    - id: errorCountLod2InvalidSurface
      nodeId: 675fc95a-e4ca-4381-9b68-367a71c49a96
      port: default
    - id: errorCountLod3InvalidSurface
      nodeId: c8873b8c-6074-4792-8c27-9a1f134df143
      port: default
    - id: errorCountLod4InvalidSurface
      nodeId: 7bbd918a-d05e-402d-b868-05c58f2c7cd8
      port: default
    - id: errorCountIncorrectMeshcode
      nodeId: 0d5eb4ef-3a3f-44d7-b405-2e6de9c047d6
      port: default
    - id: errorCountLod2NotClosedSolid
      nodeId: 6ab9693b-916e-4bb9-84db-5edf7ce9b19f
      port: default
    - id: errorCountLod3NotClosedSolid
      nodeId: 4c7aa7ea-ceab-4013-8222-3529bd1969c0
      port: default
    - id: errorCountLod4NotClosedSolid
      nodeId: fb371d4a-121a-4d58-b528-8ecd322a7eac
      port: default
    - id: errorCountLod2SolidIssues
      nodeId: 8d713e5a-5554-4c02-a726-dda22cd1356d
      port: default
    - id: errorCountLod3SolidIssues
      nodeId: 52801a23-9945-4852-bbe2-99e2afcd6497
      port: default
    - id: errorCountLod4SolidIssues
      nodeId: 7e45c3ce-3b7d-42fb-a51b-aa7a5ea258e8
      port: default
    - id: errorCountLod1SolidIntersection
      nodeId: 48caed0f-8784-40dc-ae8f-f6b55060305d
      port: default
    - id: errorCountLod2SolidIntersection
      nodeId: fe51cc50-087e-4287-b3a5-90aca26bb3a2
      port: default
    - id: errorCountLod3SolidIntersection
      nodeId: 2aba5bc7-3bf1-4626-a4a5-ec1bcbf8091a
      port: default
    - id: errorCountLod4SolidIntersection
      nodeId: cd3d3545-3264-411d-92c1-12a39dde7c8b
      port: default
    - id: fileOutput
      nodeId: ca5721b4-fcdb-4f2b-8f2a-5a46e675aefb
      port: default
- id: 8a6c4f2e-9b1d-4e7a-b3c5-6f8e2a4b9d7c
  name: entry_point
  nodes:
  - id: 4d7b9e2a-5c8f-41d6-b9a3-7e1c5f8d2b9a
    name: FeatureCreator
    type: action
    action: FeatureCreator
    with:
      creator: |
        [
          #{
            cityGmlPath: env.get("cityGmlPath"),
            cityCode: env.get("cityCode") ?? file::extract_filename(env.get("cityGmlPath"))[0..5],
            baseCityCode: env.get("cityCode") ?? file::extract_filename(env.get("cityGmlPath"))[0..5],
            objectListPath: env.get("objectLists"),
            codelists: env.get("codelists"),
            schemas: env.get("schemas"),
          },
        ]
  - id: c7315341-26b3-4405-9d02-039d721cd225
    name: DirectoryDecompressor
    type: action
    action: DirectoryDecompressor
    with:
      archiveAttributes:
      - codelists
      - schemas
  - id: 2aaa4ac9-2e79-479f-aa50-6543f461a76e
    name: FeatureFilePathExtractor
    type: action
    action: FeatureFilePathExtractor
    with:
      destPrefix: udx
      sourceDataset: |
        env.get("__value")["cityGmlPath"]
      extractArchive: true
  - id: 0daf7972-4d58-4ccd-a576-f3dfc418f749
    name: FeatureFilterByGml
    type: action
    action: FeatureFilter
    with:
      conditions:
      - expr: |
          env.get("__value").extension == "gml"
        outputPort: default
  - id: 151fbadf-1b40-4264-a003-f6f11f6af2d6
    name: FeatureCounterFileIndex
    type: action
    action: FeatureCounter
    with:
      countStart: 1
      outputAttribute: fileIndex
  - id: 7e833060-f8c4-458b-a8cc-8c817527f25b
    name: PLATEAU4.UDXFolderExtractor
    type: action
    action: PLATEAU4.UDXFolderExtractor
    with:
      cityGmlPath: |
        env.get("__value")["path"]
      codelistsPath: codelists
      schemasPath: schemas
  - id: 7a561c34-2e94-4883-91e4-4026b09c2f8a
    name: ReferenceAndTypeChecker
    type: subGraph
    subGraphId: 34e55bec-9185-4a66-9c41-3dbddc1e64fa
  - id: 3f7b2a9d-1c8e-4a6f-b5d3-9e2c7a4f8b1d
    name: FeatureCityGmlReader
    type: action
    action: FeatureCityGmlReader
    with:
      format: citygml
      flatten: true
      dataset: |
        env.get("__value")["gmlPath"]
  - id: 7c3e8b1f-2a9d-4f6c-8e5a-9b2d4f7c1e8a
    name: AttributeMapperGmlPathAndFilename
    type: action
    action: AttributeMapper
    with:
      mappers:
      - attribute: gmlPath
        expr: |
          env.get("__value").path
      - attribute: gmlFilename
        expr: |
          env.get("__value").name
      - attribute: fileIndex
        expr: |
          env.get("__value").fileIndex
  - id: a8a7e7f8-8d73-4078-9cff-4476924f2ad7
    name: FeatureSorter
    type: action
    action: FeatureSorter
    with:
      attributes:
      - fileIndex
      order: ascending
  - id: 5a7b1469-217a-4d4b-bb01-971a9f9140d8
    name: FeatureCounterFeatureIndex
    type: action
    action: FeatureCounter
    with:
      countStart: 0
      outputAttribute: featureIndex
  - id: 00e04196-60a5-4e0e-8389-74d2d0fad6e1
    name: AppearanceRemover
    type: action
    action: AppearanceRemover
  - id: e51ebef4-2a0f-4c67-abdc-1583db29a72b
    name: AttributeManagerRemoveUnusedAttributesForGeometryChecks
    type: action
    action: AttributeManager
    with:
      operations:
      - attribute: gmlPath
        method: remove
      - attribute: cityGmlAttributes
        method: remove
      - attribute: gmlName
        method: remove
  - id: 10df06f3-cafa-4abd-ba94-04ac71dae467
    name: HorizontalReprojector
    type: action
    action: HorizontalReprojector
    with:
      epsgCode: 10168
  - id: 2b8c4e7a-9f1d-4a3b-c6e8-5d2a7b9c1e4f
    name: FeatureFilterBuildingPart
    type: action
    action: FeatureFilter
    with:
      conditions:
      - expr: 'true'
        outputPort: default
      - expr: |
          env.get("__value").featureType == "bldg:BuildingPart"
        outputPort: buildingPart
  - id: 7f3a8d2c-4e6b-4d9a-b1c5-3e8f2a7d9c4b
    name: FormatChecker
    type: subGraph
    subGraphId: 36d6a846-80a8-48e9-9c34-d7c0b8af2d6d
  - id: e9f2c5b8-3a7d-4c1e-8b6f-2d9a5c8e1b4f
    name: SurfaceValidation
    type: subGraph
    subGraphId: a9952b0d-e085-4a0b-bb76-fa36b969c96b
  - id: 3e9f7c2a-8b4d-4e1f-a9c5-6b8e2c4a7d9f
    name: BuildingPartValidation
    type: subGraph
    subGraphId: 1a2b3c4d-5e6f-7a8b-9c0d-1e2f3a4b5c6d
  - id: b1c2d3e4-5f6a-7b8c-9d0e-1f2a3b4c5d6e
    name: FileInfoExtractor
    type: action
    action: AttributeMapper
    with:
      mappers:
      - attribute: index
        expr: |
          env.get("__value").fileIndex
      - attribute: filename
        expr: |
          env.get("__value").gmlFilename
  - id: 4712539b-5103-41ee-9359-0333eefb82ef
    name: GeometryRemoverForErrorSummary
    type: action
    action: GeometryRemover
  - id: c2d3e4f5-6a7b-8c9d-0e1f-2a3b4c5d6e7f
    name: ErrorSummaryMerger
    type: action
    action: FeatureMerger
    with:
      requestorAttributeValue: |
        env.get("__value").filename
      supplierAttributeValue: |
        env.get("__value").gmlFilename
  - id: d3e4f5a6-7b8c-9d0e-1f2a-3b4c5d6e7f8a
    name: SummaryAttributeMapper
    type: action
    action: AttributeMapper
    with:
      mappers:
      - attribute: Index
        expr: |
          env.get("__value").index
      - attribute: Filename
        expr: |
          env.get("__value").filename
      - attribute: WallSurface
        expr: |
          env.get("__value").WallSurface ?? 0
      - attribute: BuildingFurniture
        expr: |
          env.get("__value").BuildingFurniture ?? 0
      - attribute: Building
        expr: |
          env.get("__value").Building ?? 0
      - attribute: OuterCeilingSurface
        expr: |
          env.get("__value").OuterCeilingSurface ?? 0
      - attribute: BuildingInstallation
        expr: |
          env.get("__value").BuildingInstallation ?? 0
      - attribute: ClosureSurface
        expr: |
          env.get("__value").ClosureSurface ?? 0
      - attribute: InteriorWallSurface
        expr: |
          env.get("__value").InteriorWallSurface ?? 0
      - attribute: RoofSurface
        expr: |
          env.get("__value").RoofSurface ?? 0
      - attribute: Room
        expr: |
          env.get("__value").Room ?? 0
      - attribute: OuterFloorSurface
        expr: |
          env.get("__value").OuterFloorSurface ?? 0
      - attribute: GroundSurface
        expr: |
          env.get("__value").GroundSurface ?? 0
      - attribute: Window
        expr: |
          env.get("__value").Window ?? 0
      - attribute: CeilingSurface
        expr: |
          env.get("__value").CeilingSurface ?? 0
      - attribute: BuildingPart
        expr: |
          env.get("__value").BuildingPart ?? 0
      - attribute: FloorSurface
        expr: |
          env.get("__value").FloorSurface ?? 0
      - attribute: Door
        expr: |
          env.get("__value").Door ?? 0
      - attribute: IntBuildingInstallation
        expr: |
          env.get("__value").IntBuildingInstallation ?? 0
      - attribute: 市区町村コードエラー
        expr: |
          env.get("__value")._num_incorrect_city_code ?? 0
      - attribute: C-bldg-01 エラー
        expr: |
          env.get("__value")._num_duplicate_building_id ?? 0
      - attribute: 不正な建物ID
        expr: |
          env.get("__value")._num_missing_building_id ?? 0
      - attribute: L-bldg-02 エラー
        expr: |
          env.get("__value")._num_lbldg02_error ?? 0
      - attribute: L-bldg-04,05 エラー
        expr: |
          env.get("__value")._num_incorrect_usage_attribute ?? 0
      - attribute: L-bldg-06 エラー
        expr: |
          env.get("__value")._num_lbldg06_error ?? 0
      - attribute: T-bldg-02エラー
        expr: |
          env.get("__value")._num_invalid_bldginst_geom_type ?? 0
      - attribute: LOD0 面のエラー
        expr: |
          env.get("__value")._num_lod0_invalid_surface ?? 0
      - attribute: LOD0 面の向きエラー
        expr: |
          env.get("__value")._num_lod0_incorrect_orientation ?? 0
      - attribute: LOD0 面の交差
        expr: |
          env.get("__value")._num_lod0_surface_intersection ?? 0
      - attribute: LOD1 境界面のエラー
        expr: |
          env.get("__value")._num_lod1_invalid_surface ?? 0
      - attribute: LOD1 非水密立体
        expr: |
          env.get("__value")._num_lod1_not_closed_solid ?? 0
      - attribute: LOD1 立体のエラー
        expr: |
          env.get("__value")._num_lod1_solid_issues ?? 0
      - attribute: LOD2 境界面のエラー
        expr: |
          env.get("__value")._num_lod2_invalid_surface ?? 0
      - attribute: LOD3 境界面のエラー
        expr: |
          env.get("__value")._num_lod3_invalid_surface ?? 0
      - attribute: LOD4 境界面のエラー
        expr: |
          env.get("__value")._num_lod4_invalid_surface ?? 0
      - attribute: LOD2 非水密立体
        expr: |
          env.get("__value")._num_lod2_not_closed_solid ?? 0
      - attribute: LOD3 非水密立体
        expr: |
          env.get("__value")._num_lod3_not_closed_solid ?? 0
      - attribute: LOD4 非水密立体
        expr: |
          env.get("__value")._num_lod4_not_closed_solid ?? 0
      - attribute: LOD2 立体のエラー
        expr: |
          env.get("__value")._num_lod2_solid_issues ?? 0
      - attribute: LOD3 立体のエラー
        expr: |
          env.get("__value")._num_lod3_solid_issues ?? 0
      - attribute: LOD4 立体のエラー
        expr: |
          env.get("__value")._num_lod4_solid_issues ?? 0
      - attribute: 図郭不正
        expr: |
          env.get("__value")._num_incorrect_meshcode ?? 0
      - attribute: LOD0-1のBuildingPart
        expr: |
          env.get("__value")._num_lod0_1_buildingpart ?? 0
      - attribute: LOD1 立体の交差
        expr: |
          env.get("__value")._num_lod1_solid_intersection ?? 0
      - attribute: LOD2 立体の交差
        expr: |
          env.get("__value")._num_lod2_solid_intersection ?? 0
      - attribute: LOD3 立体の交差
        expr: |
          env.get("__value")._num_lod3_solid_intersection ?? 0
      - attribute: LOD4 立体の交差
        expr: |
          env.get("__value")._num_lod4_solid_intersection ?? 0
  - id: e4f5a6b7-8c9d-0e1f-2a3b-4c5d6e7f8a9b
    name: CSVSummaryWriter
    type: action
    action: FeatureWriter
    with:
      format: csv
      output: |
        file::join_path(env.get("workerArtifactPath") ?? env.get("outputPath"), "02_建築物_検査結果一覧.csv")
  - id: f5a6b7c8-9d0e-1f2a-3b4c-5d6e7f8a9b0c
    name: StatisticsCalculator
    type: action
    action: StatisticsCalculator
    with:
      calculations:
      - newAttribute: C-bldg-01 エラー
        expr: |
          env.get("__value")["C-bldg-01 エラー"] ?? 0
      - newAttribute: 不正な建物ID
        expr: |
          env.get("__value")["不正な建物ID"] ?? 0
      - newAttribute: 市区町村コードエラー
        expr: |
          env.get("__value")["市区町村コードエラー"] ?? 0
      - newAttribute: L-bldg-02 エラー
        expr: |
          env.get("__value")["L-bldg-02 エラー"] ?? 0
      - newAttribute: L-bldg-04,05 エラー
        expr: |
          env.get("__value")["L-bldg-04,05 エラー"] ?? 0
      - newAttribute: L-bldg-06 エラー
        expr: |
          env.get("__value")["L-bldg-06 エラー"] ?? 0
      - newAttribute: LOD0 面のエラー
        expr: |
          env.get("__value")["LOD0 面のエラー"] ?? 0
      - newAttribute: LOD0 面の向きエラー
        expr: |
          env.get("__value")["LOD0 面の向きエラー"] ?? 0
      - newAttribute: LOD0 面の交差
        expr: |
          env.get("__value")["LOD0 面の交差"] ?? 0
      - newAttribute: LOD1 境界面のエラー
        expr: |
          env.get("__value")["LOD1 境界面のエラー"] ?? 0
      - newAttribute: LOD1 非水密立体
        expr: |
          env.get("__value")["LOD1 非水密立体"] ?? 0
      - newAttribute: LOD1 立体のエラー
        expr: |
          env.get("__value")["LOD1 立体のエラー"] ?? 0
      - newAttribute: LOD1 立体の交差
        expr: |
          env.get("__value")["LOD1 立体の交差"] ?? 0
      - newAttribute: LOD2 境界面のエラー
        expr: |
          env.get("__value")["LOD2 境界面のエラー"] ?? 0
      - newAttribute: LOD2 非水密立体
        expr: |
          env.get("__value")["LOD2 非水密立体"] ?? 0
      - newAttribute: LOD2 立体のエラー
        expr: |
          env.get("__value")["LOD2 立体のエラー"] ?? 0
      - newAttribute: LOD2 立体の交差
        expr: |
          env.get("__value")["LOD2 立体の交差"] ?? 0
      - newAttribute: LOD3 境界面のエラー
        expr: |
          env.get("__value")["LOD3 境界面のエラー"] ?? 0
      - newAttribute: LOD3 非水密立体
        expr: |
          env.get("__value")["LOD3 非水密立体"] ?? 0
      - newAttribute: LOD3 立体のエラー
        expr: |
          env.get("__value")["LOD3 立体のエラー"] ?? 0
      - newAttribute: LOD3 立体の交差
        expr: |
          env.get("__value")["LOD3 立体の交差"] ?? 0
      - newAttribute: LOD4 境界面のエラー
        expr: |
          env.get("__value")["LOD4 境界面のエラー"] ?? 0
      - newAttribute: LOD4 非水密立体
        expr: |
          env.get("__value")["LOD4 非水密立体"] ?? 0
      - newAttribute: LOD4 立体のエラー
        expr: |
          env.get("__value")["LOD4 立体のエラー"] ?? 0
      - newAttribute: LOD4 立体の交差
        expr: |
          env.get("__value")["LOD4 立体の交差"] ?? 0
      - newAttribute: T-bldg-02エラー
        expr: |
          env.get("__value")["T-bldg-02エラー"] ?? 0
      - newAttribute: LOD0-1のBuildingPart
        expr: |
          env.get("__value")["LOD0-1のBuildingPart"] ?? 0
      - newAttribute: totalErrorCount
        expr: |
          let total = 0;
          let keys = ["C-bldg-01 エラー", "不正な建物ID", "市区町村コードエラー",
                      "L-bldg-02 エラー", "L-bldg-04,05 エラー", "L-bldg-06 エラー",
                      "LOD0 面のエラー", "LOD0 面の向きエラー", "LOD0 面の交差",
                      "LOD1 境界面のエラー", "LOD1 非水密立体", "LOD1 立体のエラー", "LOD1 立体の交差",
                      "LOD2 境界面のエラー", "LOD2 非水密立体", "LOD2 立体のエラー", "LOD2 立体の交差",
                      "LOD3 境界面のエラー", "LOD3 非水密立体", "LOD3 立体のエラー", "LOD3 立体の交差",
                      "LOD4 境界面のエラー", "LOD4 非水密立体", "LOD4 立体のエラー", "LOD4 立体の交差",
                      "T-bldg-02エラー", "LOD0-1のBuildingPart", "図郭不正"];
          for key in keys {
            total += env.get("__value")[key] ?? 0;
          }
          total
  - id: a6b7c8d9-0e1f-2a3b-4c5d-6e7f8a9b0c1d
    name: JSONSummaryWriter
    type: action
    action: FeatureWriter
    with:
      format: json
      converter: |
        if env.get("__features").is_empty() {
          []
        } else {
          let result = [];
          let feature = env.get("__features")[0];
          for key in feature.keys() {
            result.push(#{
              name: key,
              count: feature[key],
            });
          }
          result
        }
      output: |
        file::join_path(env.get("workerArtifactPath") ?? env.get("outputPath"), "summary_bldg.json")
  - id: 9e0f1a2b-3c4d-5e6f-7a8b-9c0d1e2f3a4b
    name: StatisticsCalculatorTotalErrors
    type: action
    action: StatisticsCalculator
    with:
      calculations:
      - newAttribute: totalErrorCount
        expr: |
          env.get("__value")["totalErrorCount"] ?? 0
  - id: a1b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d
    name: FeatureFilterNoErrors
    type: action
    action: FeatureFilter
    with:
      conditions:
      - expr: |
          env.get("__value")["totalErrorCount"] == 0
        outputPort: default
  - id: b2c3d4e5-6f7a-8b9c-0d1e-2f3a4b5c6d7e
    name: FileWriterQcResultOk
    type: action
    action: JsonWriter
    with:
      converter: '[]'
      output: |
        let filename = file::extract_filename_without_ext(env.get("cityGmlPath")) + "_qc_result_ok";
        let dirname = env.get("workerArtifactPath") ?? env.get("outputPath");
        file::join_path(dirname, filename)
  - id: 9f8e7d6c-5b4a-3928-1716-0f5e4d3c2b1a
    name: ZipFileWriter
    type: action
    action: ZipFileWriter
    with:
      output: |
        let filename = file::extract_filename_without_ext(env.get("cityGmlPath")) + "_qc_result.zip";
        let dirname = env.get("workerArtifactPath") ?? env.get("outputPath");
        file::join_path(dirname, filename)
  edges:
  - id: 8c9e2f4a-7b1d-4e5c-a3f2-9d8b6c4e1a7f
    from: 4d7b9e2a-5c8f-41d6-b9a3-7e1c5f8d2b9a
    to: c7315341-26b3-4405-9d02-039d721cd225
    fromPort: default
    toPort: default
  - id: f3a7b2e5-4c8d-4f9a-bce2-5f1a8d3b9c6e
    from: c7315341-26b3-4405-9d02-039d721cd225
    to: 2aaa4ac9-2e79-479f-aa50-6543f461a76e
    fromPort: default
    toPort: default
  - id: 2d6e9b4c-a5f8-4e2d-b7c3-8a1f4e7b2d5c
    from: 2aaa4ac9-2e79-479f-aa50-6543f461a76e
    to: 0daf7972-4d58-4ccd-a576-f3dfc418f749
    fromPort: default
    toPort: default
  - id: 7a2e5c8f-3b9d-4c6a-e5f1-2d8c7b4a9e3f
    from: 0daf7972-4d58-4ccd-a576-f3dfc418f749
    to: 151fbadf-1b40-4264-a003-f6f11f6af2d6
    fromPort: default
    toPort: default
  - id: 9f4c7a2e-6b1d-4f8c-a2e5-3d9f6c8a1e4b
    from: 151fbadf-1b40-4264-a003-f6f11f6af2d6
    to: 7e833060-f8c4-458b-a8cc-8c817527f25b
    fromPort: default
    toPort: default
  - id: 4b7e2a9c-5f1d-4a8e-f2c6-7b4a1e8d5c9f
    from: 7e833060-f8c4-458b-a8cc-8c817527f25b
    to: 7c3e8b1f-2a9d-4f6c-8e5a-9b2d4f7c1e8a
    fromPort: default
    toPort: default
  - id: 3c8f1a5e-6b2d-4e9c-a7f4-1b8e5d2c9a6f
    from: 7c3e8b1f-2a9d-4f6c-8e5a-9b2d4f7c1e8a
    to: 3f7b2a9d-1c8e-4a6f-b5d3-9e2c7a4f8b1d
    fromPort: default
    toPort: default
  - id: 7f34f420-3b27-44a8-b83f-0ef80a86045e
    from: 3f7b2a9d-1c8e-4a6f-b5d3-9e2c7a4f8b1d
    to: a8a7e7f8-8d73-4078-9cff-4476924f2ad7
    fromPort: default
    toPort: default
  - id: 1cc52f00-2a52-4d4e-bc6a-c83629276766
    from: a8a7e7f8-8d73-4078-9cff-4476924f2ad7
    to: 5a7b1469-217a-4d4b-bb01-971a9f9140d8
    fromPort: default
    toPort: default
  - id: a4b7e1d9-2c8f-4a5b-d3e6-9c2a5b8e1d4f
    from: 5a7b1469-217a-4d4b-bb01-971a9f9140d8
    to: 7f3a8d2c-4e6b-4d9a-b1c5-3e8f2a7d9c4b
    fromPort: default
    toPort: default
  - id: 525487a5-0a23-4fa8-9767-41d429b87e9d
    from: 5a7b1469-217a-4d4b-bb01-971a9f9140d8
    to: 00e04196-60a5-4e0e-8389-74d2d0fad6e1
    fromPort: default
    toPort: default
  - id: aa652fa2-038c-4450-ab59-cdfa09b68f4b
    from: 00e04196-60a5-4e0e-8389-74d2d0fad6e1
    to: e51ebef4-2a0f-4c67-abdc-1583db29a72b
    fromPort: default
    toPort: default
  - id: 9a358b62-c289-4ca5-bb4f-bdf69deec04d
    from: e51ebef4-2a0f-4c67-abdc-1583db29a72b
    to: 10df06f3-cafa-4abd-ba94-04ac71dae467
    fromPort: default
    toPort: default
  - id: 10737c99-a56c-42ed-b17e-32bf1163a21e
    from: 10df06f3-cafa-4abd-ba94-04ac71dae467
    to: 2b8c4e7a-9f1d-4a3b-c6e8-5d2a7b9c1e4f
    fromPort: default
    toPort: default
  - id: f8d2c5a9-3e1b-4c7f-a6d8-9b5e2c4f1a7d
    from: 2b8c4e7a-9f1d-4a3b-c6e8-5d2a7b9c1e4f
    to: e9f2c5b8-3a7d-4c1e-8b6f-2d9a5c8e1b4f
    fromPort: default
    toPort: default
  - id: 9c4e7a2f-6b1d-4e8c-a5f3-2d8c9b4a1e7f
    from: 2b8c4e7a-9f1d-4a3b-c6e8-5d2a7b9c1e4f
    to: 3e9f7c2a-8b4d-4e1f-a9c5-6b8e2c4a7d9f
    fromPort: buildingPart
    toPort: default
  - id: 050b179b-e063-4541-b08f-31ea54ceec0f
    from: 7c3e8b1f-2a9d-4f6c-8e5a-9b2d4f7c1e8a
    to: 7a561c34-2e94-4883-91e4-4026b09c2f8a
    fromPort: default
    toPort: default
  - id: b7c8d9e0-1f2a-3b4c-5d6e-7f8a9b0c1d2e
    from: 7c3e8b1f-2a9d-4f6c-8e5a-9b2d4f7c1e8a
    to: b1c2d3e4-5f6a-7b8c-9d0e-1f2a3b4c5d6e
    fromPort: default
    toPort: default
  - id: c8d9e0f1-2a3b-4c5d-6e7f-8a9b0c1d2e3f
    from: b1c2d3e4-5f6a-7b8c-9d0e-1f2a3b4c5d6e
    to: c2d3e4f5-6a7b-8c9d-0e1f-2a3b4c5d6e7f
    fromPort: default
    toPort: requestor
  - id: aa9b0c1d-2e3f-4a5b-6c7d-8e9f0a1b2c3d
    from: 7f3a8d2c-4e6b-4d9a-b1c5-3e8f2a7d9c4b
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: featureInstanceCountC02
    toPort: default
  - id: d9e0f1a2-3b4c-5d6e-7f8a-9b0c1d2e3f4a
    from: 7f3a8d2c-4e6b-4d9a-b1c5-3e8f2a7d9c4b
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountCityCode
    toPort: default
  - id: e9f0a1b2-4c5d-6e7f-8a9b-0c1d2e3f4a5b
    from: 3e9f7c2a-8b4d-4e1f-a9c5-6b8e2c4a7d9f
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountLbldg02
    toPort: default
  - id: a3b4c5d6-8e9f-0a1b-2c3d-4e5f6a7b8c9d
    from: 3e9f7c2a-8b4d-4e1f-a9c5-6b8e2c4a7d9f
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountLod01BuildingPart
    toPort: default
  - id: f0a1b2c3-5d6e-7f8a-9b0c-1d2e3f4a5b6c
    from: 7f3a8d2c-4e6b-4d9a-b1c5-3e8f2a7d9c4b
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountL0405Bldg
    toPort: default
  - id: a1b2c3d4-6e7f-8a9b-0c1d-2e3f4a5b6c7d
    from: 7f3a8d2c-4e6b-4d9a-b1c5-3e8f2a7d9c4b
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountCBldg01
    toPort: default
  - id: b2c3d4e5-7f8a-9b0c-1d2e-3f4a5b6c7d8e
    from: 7f3a8d2c-4e6b-4d9a-b1c5-3e8f2a7d9c4b
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountMissingBuildingId
    toPort: default
  - id: c3d4e5f6-8a9b-0c1d-2e3f-4a5b6c7d8e9f
    from: 7a561c34-2e94-4883-91e4-4026b09c2f8a
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountInvalidBldgInstGeomType
    toPort: default
  - id: d4e5f6a7-9b0c-1d2e-3f4a-5b6c7d8e9f0a
    from: 7a561c34-2e94-4883-91e4-4026b09c2f8a
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountLbldg06
    toPort: default
  - id: e5f6a7b8-0c1d-2e3f-4a5b-6c7d8e9f0a1b
    from: e9f2c5b8-3a7d-4c1e-8b6f-2d9a5c8e1b4f
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountLod0IncorrectOrientation
    toPort: default
  - id: f6a7b8c9-1d2e-3f4a-5b6c-7d8e9f0a1b2c
    from: e9f2c5b8-3a7d-4c1e-8b6f-2d9a5c8e1b4f
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountLod0InvalidSurface
    toPort: default
  - id: a7b8c9d0-2e3f-4a5b-6c7d-8e9f0a1b2c3d
    from: e9f2c5b8-3a7d-4c1e-8b6f-2d9a5c8e1b4f
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountLod0SurfaceIntersection
    toPort: default
  - id: b8c9d0e1-3f4a-5b6c-7d8e-9f0a1b2c3d4e
    from: e9f2c5b8-3a7d-4c1e-8b6f-2d9a5c8e1b4f
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountLod1InvalidSurface
    toPort: default
  - id: c9d0e1f2-4a5b-6c7d-8e9f-0a1b2c3d4e5f
    from: e9f2c5b8-3a7d-4c1e-8b6f-2d9a5c8e1b4f
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountLod1NotClosedSolid
    toPort: default
  - id: d0e1f2a3-5b6c-7d8e-9f0a-1b2c3d4e5f6a
    from: e9f2c5b8-3a7d-4c1e-8b6f-2d9a5c8e1b4f
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountLod1SolidIssues
    toPort: default
  - id: e1f2a3b4-6c7d-8e9f-0a1b-2c3d4e5f6a7b
    from: e9f2c5b8-3a7d-4c1e-8b6f-2d9a5c8e1b4f
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountLod2InvalidSurface
    toPort: default
  - id: e2f3a4b5-7c8d-9e0f-1a2b-3c4d5e6f7a8b
    from: e9f2c5b8-3a7d-4c1e-8b6f-2d9a5c8e1b4f
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountLod3InvalidSurface
    toPort: default
  - id: e3f4a5b6-8c9d-0e1f-2a3b-4c5d6e7f8a9b
    from: e9f2c5b8-3a7d-4c1e-8b6f-2d9a5c8e1b4f
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountLod4InvalidSurface
    toPort: default
  - id: f3a4b5c6-8d9e-0f1a-2b3c-4d5e6f7a8b9c
    from: e9f2c5b8-3a7d-4c1e-8b6f-2d9a5c8e1b4f
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountLod2NotClosedSolid
    toPort: default
  - id: f4a5b6c7-9d0e-1f2a-3b4c-5d6e7f8a9b0c
    from: e9f2c5b8-3a7d-4c1e-8b6f-2d9a5c8e1b4f
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountLod3NotClosedSolid
    toPort: default
  - id: f5a6b7c8-0e1f-2a3b-4c5d-6e7f8a9b0c1d
    from: e9f2c5b8-3a7d-4c1e-8b6f-2d9a5c8e1b4f
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountLod4NotClosedSolid
    toPort: default
  - id: f6a7b8c9-1f2a-3b4c-5d6e-7f8a9b0c1d2e
    from: e9f2c5b8-3a7d-4c1e-8b6f-2d9a5c8e1b4f
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountLod2SolidIssues
    toPort: default
  - id: f7a8b9c0-2f3a-4b5c-6d7e-8f9a0b1c2d3e
    from: e9f2c5b8-3a7d-4c1e-8b6f-2d9a5c8e1b4f
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountLod3SolidIssues
    toPort: default
  - id: f8a9b0c1-3f4a-5b6c-7d8e-9f0a1b2c3d4e
    from: e9f2c5b8-3a7d-4c1e-8b6f-2d9a5c8e1b4f
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountLod4SolidIssues
    toPort: default
  - id: f2a3b4c5-7d8e-9f0a-1b2c-3d4e5f6a7b8c
    from: e9f2c5b8-3a7d-4c1e-8b6f-2d9a5c8e1b4f
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountIncorrectMeshcode
    toPort: default
  - id: a9b0c1d2-3e4f-5a6b-7c8d-9e0f1a2b3c4d
    from: e9f2c5b8-3a7d-4c1e-8b6f-2d9a5c8e1b4f
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountLod1SolidIntersection
    toPort: default
  - id: b0c1d2e3-4f5a-6b7c-8d9e-0f1a2b3c4d5e
    from: e9f2c5b8-3a7d-4c1e-8b6f-2d9a5c8e1b4f
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountLod2SolidIntersection
    toPort: default
  - id: c1d2e3f4-5a6b-7c8d-9e0f-1a2b3c4d5e6f
    from: e9f2c5b8-3a7d-4c1e-8b6f-2d9a5c8e1b4f
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountLod3SolidIntersection
    toPort: default
  - id: d2e3f4a5-6b7c-8d9e-0f1a-2b3c4d5e6f7a
    from: e9f2c5b8-3a7d-4c1e-8b6f-2d9a5c8e1b4f
    to: 4712539b-5103-41ee-9359-0333eefb82ef
    fromPort: errorCountLod4SolidIntersection
    toPort: default
  - id: b2d5f9dd-b4ab-4db5-9255-7ca5a12c8fa9
    from: 4712539b-5103-41ee-9359-0333eefb82ef
    to: c2d3e4f5-6a7b-8c9d-0e1f-2a3b4c5d6e7f
    fromPort: default
    toPort: supplier
  - id: e0f1a2b3-4c5d-6e7f-8a9b-0c1d2e3f4a5b
    from: c2d3e4f5-6a7b-8c9d-0e1f-2a3b4c5d6e7f
    to: d3e4f5a6-7b8c-9d0e-1f2a-3b4c5d6e7f8a
    fromPort: merged
    toPort: default
  - id: 17d7e700-3403-4be4-bc31-f40eabe10d1b
    from: c2d3e4f5-6a7b-8c9d-0e1f-2a3b4c5d6e7f
    to: d3e4f5a6-7b8c-9d0e-1f2a-3b4c5d6e7f8a
    fromPort: unmerged
    toPort: default
  - id: f1a2b3c4-5d6e-7f8a-9b0c-1d2e3f4a5b6c
    from: d3e4f5a6-7b8c-9d0e-1f2a-3b4c5d6e7f8a
    to: e4f5a6b7-8c9d-0e1f-2a3b-4c5d6e7f8a9b
    fromPort: default
    toPort: default
  - id: a2b3c4d5-6e7f-8a9b-0c1d-2e3f4a5b6c7d
    from: d3e4f5a6-7b8c-9d0e-1f2a-3b4c5d6e7f8a
    to: f5a6b7c8-9d0e-1f2a-3b4c-5d6e7f8a9b0c
    fromPort: default
    toPort: default
  - id: b3c4d5e6-7f8a-9b0c-1d2e-3f4a5b6c7d8e
    from: f5a6b7c8-9d0e-1f2a-3b4c-5d6e7f8a9b0c
    to: a6b7c8d9-0e1f-2a3b-4c5d-6e7f8a9b0c1d
    fromPort: default
    toPort: default
  - id: c4d5e6f7-8a9b-0c1d-2e3f-4a5b6c7d8e9f
    from: e4f5a6b7-8c9d-0e1f-2a3b-4c5d6e7f8a9b
    to: 9f8e7d6c-5b4a-3928-1716-0f5e4d3c2b1a
    fromPort: default
    toPort: default
  - id: d5e6f7a8-9b0c-1d2e-3f4a-5b6c7d8e9f0a
    from: a6b7c8d9-0e1f-2a3b-4c5d-6e7f8a9b0c1d
    to: 9f8e7d6c-5b4a-3928-1716-0f5e4d3c2b1a
    fromPort: default
    toPort: default
  - id: e6f7a8b9-0c1d-2e3f-4a5b-6c7d8e9f0a1b
    from: 7f3a8d2c-4e6b-4d9a-b1c5-3e8f2a7d9c4b
    to: 9f8e7d6c-5b4a-3928-1716-0f5e4d3c2b1a
    fromPort: fileOutput
    toPort: default
  - id: f7a8b9c0-1d2e-3f4a-5b6c-7d8e9f0a1b2c
    from: 7a561c34-2e94-4883-91e4-4026b09c2f8a
    to: 9f8e7d6c-5b4a-3928-1716-0f5e4d3c2b1a
    fromPort: fileOutput
    toPort: default
  - id: a8b9c0d1-2e3f-4a5b-6c7d-8e9f0a1b2c3d
    from: e9f2c5b8-3a7d-4c1e-8b6f-2d9a5c8e1b4f
    to: 9f8e7d6c-5b4a-3928-1716-0f5e4d3c2b1a
    fromPort: fileOutput
    toPort: default
  - id: b9c0d1e2-3f4a-5b6c-7d8e-9f0a1b2c3d4e
    from: 3e9f7c2a-8b4d-4e1f-a9c5-6b8e2c4a7d9f
    to: 9f8e7d6c-5b4a-3928-1716-0f5e4d3c2b1a
    fromPort: fileOutput
    toPort: default
  - id: c3d4e5f6-7a8b-9c0d-1e2f-3a4b5c6d7e8f
    from: f5a6b7c8-9d0e-1f2a-3b4c-5d6e7f8a9b0c
    to: 9e0f1a2b-3c4d-5e6f-7a8b-9c0d1e2f3a4b
    fromPort: default
    toPort: default
  - id: e5f6a7b8-9c0d-1e2f-3a4b-5c6d7e8f9a0b
    from: 9e0f1a2b-3c4d-5e6f-7a8b-9c0d1e2f3a4b
    to: a1b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d
    fromPort: default
    toPort: default
  - id: f6a7b8c9-0d1e-2f3a-4b5c-6d7e8f9a0b1c
    from: a1b2c3d4-5e6f-7a8b-9c0d-1e2f3a4b5c6d
    to: b2c3d4e5-6f7a-8b9c-0d1e-2f3a4b5c6d7e
    fromPort: default
    toPort: default
